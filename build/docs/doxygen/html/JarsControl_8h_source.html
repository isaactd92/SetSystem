<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GNU Radio&#39;s SETSYSTEM Package: JarsControl.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GNU Radio&#39;s SETSYSTEM Package
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('JarsControl_8h_source.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">JarsControl.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="JarsControl_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef ARGPROCESSOR_JARSCONTROL_JARSCONTROL_H_</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define ARGPROCESSOR_JARSCONTROL_JARSCONTROL_H_</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RdpToolsBeta_8h.html">RdpToolsBeta/RdpToolsBeta.h</a>&quot;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//************************#include &quot;arriba/\&quot;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;pthread.h&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;zmq.hpp&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include  &lt;vector&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;assert.h&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;bits/stdc++.h&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;sys/socket.h&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;netinet/in.h&gt;</span><span class="comment">//define las estructuras : struct sockaddr_in, struct in_addr</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;arpa/inet.h&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;netdb.h&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//******************************* librerías para socket UDP bind ****************************************************</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;gnuradio/math.h&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;gnuradio/prefs.h&gt;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;stdexcept&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;errno.h&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;boost/asio.hpp&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;boost/format.hpp&gt;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;gnuradio/thread/thread.h&gt;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//********************************************************************************************************************</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//************************************Structura fpga_con_t *******************************************************</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//boost::asio::ip::udp::endpoint local_endpoint;</span></div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#a422d981f24f5424243f875df0a9ade6b">   41</a></span>&#160;boost::asio::ip::udp::socket* <a class="code" href="JarsControl_8h.html#a422d981f24f5424243f875df0a9ade6b">local_socket</a>;</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#aa6e78a1fa6723425d76b1aae3928fc9b">   42</a></span>&#160;boost::asio::io_service <a class="code" href="JarsControl_8h.html#aa6e78a1fa6723425d76b1aae3928fc9b">local_io_service</a>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#acc668b68847453065b3681978e25f217">   44</a></span>&#160;boost::asio::ip::udp::endpoint <a class="code" href="JarsControl_8h.html#acc668b68847453065b3681978e25f217">destino_endpoint</a>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keywordtype">void</span> <a class="code" href="JarsControl_8h.html#ab2dd9706c8afee0101f9fb673f23a9e1">fpga_con_init</a>(<span class="keywordtype">char</span>* host, <span class="keywordtype">int</span> lport);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;ssize_t <a class="code" href="JarsControl_8h.html#a8ec1b8a8eeca1b70875f6a4c037dc3e1">fpga_con_send</a>( <span class="keyword">const</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> len );</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;ssize_t <a class="code" href="JarsControl_8h.html#afd1cbc76708d71bb56dfcaf96eb90eba">fpga_con_recv</a>(<span class="keywordtype">char</span> *dbuf, <span class="keywordtype">size_t</span> dsize );</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keywordtype">void</span> <a class="code" href="JarsControl_8h.html#ae3793cb02de7605c651d1762415629f8">IPstr_to_bytearray</a>(<span class="keywordtype">char</span> *IPstr, <span class="keywordtype">char</span> *parts);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keywordtype">void</span> <a class="code" href="JarsControl_8h.html#a9fe1a038e1882c74961f61186cc7a811">MACstr_to_bytearray</a>(<span class="keywordtype">char</span> *MACstr, <span class="keywordtype">char</span> *parts);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordtype">void</span> <a class="code" href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e">intToBytes</a>(<span class="keywordtype">int</span> number, <span class="keywordtype">char</span> *arrayOfByte, <span class="keywordtype">size_t</span> size);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keywordtype">void</span> <a class="code" href="JarsControl_8h.html#a0a6858dd58a8b8b154e5dd149fafd01d">bytearray_to_IPstr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *bytes, <span class="keywordtype">char</span> *IPstr);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keywordtype">void</span> <a class="code" href="JarsControl_8h.html#a19a52ae0d3c91c019542bc76a720aef9">bytearray_to_int</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *byte_array, <span class="keywordtype">int</span> num);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keywordtype">void</span> <a class="code" href="JarsControl_8h.html#a186f7c0fc2f44b39853cd79d8daa6b65">bytearray_to_MACstr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *bytes, <span class="keywordtype">char</span> *MACstr);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordtype">char</span>* <a class="code" href="JarsControl_8h.html#a44ec176a02a62ada468ebde1b3f6e9f0">itoa</a>(<span class="keywordtype">int</span> num, <span class="keywordtype">char</span>* str, <span class="keywordtype">int</span> base);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//*****************************************************************************************************************************</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//****************************** Clase SP601_command ********************************************************************</span></div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#ae6cae658beb94f4ddfcaa58ee33dd38b">   60</a></span>&#160;<span class="preprocessor">#define RCV_BUFSIZE 1472</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a578a2dc0f32dacf50c510f7009c12d1f">   62</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152">JARS_CMD</a> { <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a7316843e88740cd819c6427a7f833df6">NOOP</a>, <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152abff6b2d1371663911c20d04738892bfd">SET_SP601_IP</a>, <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a578a2dc0f32dacf50c510f7009c12d1f">SET_SP601_PORT</a>, <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a9dd105b07676790bd963c49f607588b9">GET_SP601_MAC</a>, <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152abd7b2f700ca4ef2b11180557059e6bbd">SET_COMMS_IP</a>, <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a57446329e1b880f1e79096d89ca90abf">SET_COMMS_PORT</a>, <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152aedb06bfaf37d18638b99cabc860b5c4b">SET_COMMS_MAC</a>, <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152af2fb94d1fd1739ad68220e57882efa23">GET_VALUE</a>, <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a55636b09cf88b31facd828042757e8cd">DATA_LOOPS</a>, <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a685f467976dffd4af61e2c198bba3e07">SEND_COMMAND</a>, <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a977ee7b118a6816596e05f1c5c6221f2">CHECK_ACK</a>, <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a28b6b130f7a5b8cdbee96bb17ef151af">SEND_FILTER</a>};</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="structaddress.html">   64</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structaddress.html">address</a>{</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="structaddress.html#a581926a36870deaba867743219d89d9a">   65</a></span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="structaddress.html#a581926a36870deaba867743219d89d9a">d_path_file</a>;</div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="structaddress.html#a47c83523d9cc06ed386f29e5fcd5eeda">   66</a></span>&#160;   std::string <a class="code" href="structaddress.html#a47c83523d9cc06ed386f29e5fcd5eeda">d_mac_block</a>;</div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="structaddress.html#aeeeea32d04a247d4a5351e33af8674a8">   67</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="structaddress.html#aeeeea32d04a247d4a5351e33af8674a8">d_port_block</a>;</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="structaddress.html#aacbeb5a1db9cfa6bcabb47d819818b1e">   68</a></span>&#160;   std::string <a class="code" href="structaddress.html#aacbeb5a1db9cfa6bcabb47d819818b1e">d_ip_host</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;};</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">// Se utilizan las definiciones de comandos del archivo ExperimentConstants.h</span></div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#a1aa9678f48f9b9661062c9246e64993a">   72</a></span>&#160;<span class="preprocessor">#define         RST_CTRL                                0x05</span></div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#a52e278dd9e601652e8ab11b70c53ef6e">   73</a></span>&#160;<span class="preprocessor">#define         MODE_OPER                               0x03</span></div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#ab8923675701bbbb7f51c4e68fac5e588">   74</a></span>&#160;<span class="preprocessor">#define         ELECTION_RXD                            0x04</span></div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#a063240a0c681e13158e249f55ac4b750">   75</a></span>&#160;<span class="preprocessor">#define         POWER_RXD                               0x06</span></div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#aefde68a634d66b7039aa56de3fd5301b">   76</a></span>&#160;<span class="preprocessor">#define         PROG_RXD                                0x09</span></div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#ad7e5e3b2ac85d92fe9b81bac2368ca02">   77</a></span>&#160;<span class="preprocessor">#define         ENABLE_TRANSF                           0x0A</span></div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#aacac2365f297d20c92dac6c32a87c6a3">   78</a></span>&#160;<span class="preprocessor">#define         DISABLE_TRANSF                          0x0B</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">//Declara la estructura jars_cmd: {&quot;NOOP&quot;,0,0,false}</span></div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="structjars__cmd.html">   81</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structjars__cmd.html">jars_cmd</a>{</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structjars__cmd.html#ac1538c1c69d889eefbabfc077e59d96f">   82</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structjars__cmd.html#ac1538c1c69d889eefbabfc077e59d96f">name</a>;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="structjars__cmd.html#a08d03301fdc843da88b71ab8d5576a97">   83</a></span>&#160;        <span class="keywordtype">char</span> <a class="code" href="structjars__cmd.html#a08d03301fdc843da88b71ab8d5576a97">val</a>;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structjars__cmd.html#a2ac9bbc25760e1a29a170271d68ea390">   84</a></span>&#160;        <span class="keywordtype">char</span> <a class="code" href="structjars__cmd.html#a2ac9bbc25760e1a29a170271d68ea390">size</a>;</div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structjars__cmd.html#a667569fb6dd6e6bc0b0699d0e1a49b22">   85</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="structjars__cmd.html#a667569fb6dd6e6bc0b0699d0e1a49b22">ack</a>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;};</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="classsp601__command.html">   89</a></span>&#160;<span class="keyword">class </span><a class="code" href="classsp601__command.html">sp601_command</a></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <a class="code" href="classsp601__command.html">sp601_command</a>();</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        ~<a class="code" href="classsp601__command.html">sp601_command</a>();</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordtype">void</span> init(<a class="code" href="structaddress.html">address</a> host_address);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        ssize_t receive(<span class="keywordtype">char</span> *buffer_rcv);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordtype">void</span> send(uint8_t cmd, <span class="keywordtype">char</span> code, <span class="keyword">const</span> <span class="keywordtype">char</span> *payload, <span class="keywordtype">size_t</span> size_payload);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;};</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">//********************************* Clase _JARSControl *********************************************************************</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">//**************************************************************************************************************************</span></div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="class__JARSControl.html">  102</a></span>&#160;<span class="keyword">class </span><a class="code" href="class__JARSControl.html">_JARSControl</a></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordtype">void</span> InternalRcv();</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordtype">void</span> InternalThreadEntry();</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordtype">void</span> InternalCallback();</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;       <span class="comment">//**********************************************************************</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="class__JARSControl.html">_JARSControl</a>();</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        ~<a class="code" href="class__JARSControl.html">_JARSControl</a>();</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">//Parameters of Experiment (luego pasar a AcquisitionManager.h)</span></div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a3a9bee0735edcc19019ea89c876bb324">  116</a></span>&#160;        <a class="code" href="classExpParameters.html">ExpParameters</a>* <a class="code" href="class__JARSControl.html#a3a9bee0735edcc19019ea89c876bb324">MyExpParam</a>;</div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a23d97fafb2a8484a913c9ae0cbf96b53">  117</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="class__JARSControl.html#a23d97fafb2a8484a913c9ae0cbf96b53">m_SizeofBuffer</a>;<span class="comment">//adquiere el valor del tamaño del buffer</span></div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="class__JARSControl.html#af22ac24cb398de0720ab962d79a8498f">  118</a></span>&#160;        <span class="keywordtype">void</span>* <a class="code" href="class__JARSControl.html#af22ac24cb398de0720ab962d79a8498f">m_AcqBuffer</a>;<span class="comment">//arreglo del buffer que guardará la data obtenida dependiendo si es short or float en tipo 16sc</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="comment">//Pointer to client function in order to get advised when interrupt came</span></div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a83109c7d938a17dcd5344b8984489490">  120</a></span>&#160;        void (*ptrFunc)(<span class="keywordtype">bool</span> success);<span class="comment">//_AcquisitionManager//toma el valor de ptrClientFunc asignado en jro_AssignMemory</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="comment">//Function that receives a pointer from ExperimentParameters</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordtype">void</span> jro_MatchParameters(<a class="code" href="classExpParameters.html">ExpParameters</a>* ExpParam);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordtype">void</span> jro_AssignMemory(<a class="code" href="classMemoryManager.html">MemoryManager</a>* MemManager, <span class="keywordtype">void</span> (*ptrClientFunc)(<span class="keywordtype">bool</span> sucess),<a class="code" href="structaddress.html">address</a> host_address);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordtype">bool</span> jro_InitAcquisition();</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordtype">bool</span> jro_StopAcquisition();</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">void</span> * InternalRcvFunc(<span class="keywordtype">void</span> * This);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">void</span> * InternalThreadEntryFunc(<span class="keywordtype">void</span> * This);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">void</span> * InternalCallbackFunc(<span class="keywordtype">void</span> * This);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">//Instanciacion de sp601_command</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="classsp601__command.html">sp601_command</a>* MySP601;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        pthread_t _thread_rcv;          <span class="comment">// thread for acquire UDP packets</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        pthread_t _thread_jars;         <span class="comment">// thread for acquire UDP packets</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        pthread_t _thread_jars_rcv;             <span class="comment">// thread for acquire UDP packets</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        pthread_t _thread_config;               <span class="comment">// thread for acquire UDP packets</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordtype">int</span> VarSetSystem;<span class="comment">//valor tomado si está mal seteado</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        int16_t m_nChannelsMask; <span class="comment">//variable q contiene la mascara de canales adquirir</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        int16_t m_nCardsMask; <span class="comment">//variable q contiene la mascara de programacion de tarjetas conectadas</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        uint16_t m_nFilterCoeff[2047]; <span class="comment">// arreglo donde se guardan los coefficientes del filtro</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordtype">size_t</span>    m_nCountCoeff; <span class="comment">// contador de coeficientes</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment">//Number of Marks, el valor para el JARS es 2</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordtype">int</span> m_NumMarks;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="comment">//Mark in Data Real</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordtype">int</span> m_MarkRe;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <span class="comment">//Pointer to Acquired Buffer</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordtype">void</span>* m_AcqNIBuffer;<span class="comment">//buffer más grande separado en memoria</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="comment">//Pointer to double memory used for Traditional NIDAQ</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordtype">void</span>* m_AcqNIDoubleBuffer;<span class="comment">//doble buffer más grande separado en memoria</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">//Payload to send jars command</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordtype">char</span> payload[16];</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="comment">/*************************************************************/</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordtype">void</span> RemoveMark(); <span class="comment">//Fx to remove marks in data</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="comment">/************************************************************/</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordtype">bool</span> RESET_CTRL_COMMAND();</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordtype">bool</span> MODE_OPER_COMMAND();</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordtype">bool</span> SELECT_RXD_COMMAND(); <span class="comment">//enviado pero no procesado.</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordtype">bool</span> PW_RXD_COMMAND();</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordtype">bool</span> PROG_RXD_COMMAND();</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordtype">bool</span> HAB_TRANS_COMMAND();</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordtype">bool</span> DESHAB_TRANS_COMMAND();</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">/************************************************************/</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordtype">bool</span> LoadMask(); <span class="comment">// Fx q carga la máscara de programación</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordtype">bool</span> ConfigDataTransfer(); <span class="comment">// Fx q envia la cantidad de muestras del perfil y NTX que se debe adquirir</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordtype">bool</span> SetSystem(<a class="code" href="structaddress.html">address</a> host_address); <span class="comment">// Funcion encargada de dejar listo el sistema para adquisicion</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordtype">bool</span> LoadFilter(); <span class="comment">// Fx q carga la los coefcicientes del filtro</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordtype">bool</span> WriteFilter(); <span class="comment">// Fx q escribe la los coefcicientes del filtro</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;};</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">//*************************************************************************************************************************</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#ab25fcf174daff72a94fd8a69424c6a2e">  175</a></span>&#160;<a class="code" href="class__JARSControl.html">_JARSControl</a> <a class="code" href="JarsControl_8h.html#ab25fcf174daff72a94fd8a69424c6a2e">JARSControl</a>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">//*************************************************************************************************************************</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">//********************************Clase sp601_config **********************************************************************</span></div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="classsp601__config.html">  179</a></span>&#160;<span class="keyword">class </span><a class="code" href="classsp601__config.html">sp601_config</a></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;{</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="classsp601__config.html#a8425fde699cfd9476b57621d6ef53129">  183</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="classsp601__config.html#a8425fde699cfd9476b57621d6ef53129">SP601_MAC</a>;                    <span class="comment">//  Must convert to hex if used//Espacio de memoria donde se guarda el valor de la MAC del SP601 + null</span></div><div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="classsp601__config.html#ad6492c0298daa685d0ba7dfc38a85b14">  184</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="classsp601__config.html#ad6492c0298daa685d0ba7dfc38a85b14">SP601_IP</a>;                     <span class="comment">// Defined in Xilnx ISE ethernet_control.v//Espacio de memoria donde se guarda el valor de la IP del SP601 + null</span></div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="classsp601__config.html#af3c1756c00b9954a476698c62911feb7">  185</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classsp601__config.html#af3c1756c00b9954a476698c62911feb7">SP601_PORT</a>;                     <span class="comment">// Defined in Xilnx ISE ethernet_control.v//Espacio de memoria donde se guarda el valor del puerto del SP601 + null</span></div><div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="classsp601__config.html#a67d08111f19266ac84a3781d1c204b6e">  186</a></span>&#160;    <span class="keywordtype">string</span> <a class="code" href="classsp601__config.html#a67d08111f19266ac84a3781d1c204b6e">sp601_ip_string</a>;             <span class="comment">// IP del SP601 usado cuando definimos un endpoint tipo boost.</span></div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classsp601__config.html#a5f4214fdc2d5b4cc6cf2665ad6233838">  187</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="classsp601__config.html#a5f4214fdc2d5b4cc6cf2665ad6233838">IP_host</a>;                      <span class="comment">// Se usará para mostrar info de la IP switch-send</span></div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="classsp601__config.html#a2c2cf407fda2eff4bfb66c2624105c7f">  188</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="classsp601__config.html#a2c2cf407fda2eff4bfb66c2624105c7f">MAC_host</a>;                     <span class="comment">// Se usará para mostrar info del MAC en switch-send</span></div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="classsp601__config.html#aa8d75acd776756f7b46560c340a4817d">  189</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classsp601__config.html#aa8d75acd776756f7b46560c340a4817d">PORT_host</a>;                      <span class="comment">// Se usará para mostrar info del puerto en switch-send</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="classsp601__config.html#a26dac3fc752ef1cac9c9a9f6f05782b0">  191</a></span>&#160;    <span class="keywordtype">char</span> REPLY_START_DATA_PAYLOAD[2];   <span class="comment">// AB, defined in DEFAULT_START_DATA_PAYLOAD (ethernet_control.v)</span></div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="classsp601__config.html#a232a589f07ec9b53c41f53954fc2acac">  192</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="classsp601__config.html#a232a589f07ec9b53c41f53954fc2acac">UDP_timeout</a>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="classsp601__config.html#a6d8f61af0597bc1c6ca208898fc76f77">  194</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classsp601__config.html#a6d8f61af0597bc1c6ca208898fc76f77">VERBOSE_MODE</a>;                  <span class="comment">// Atributo de sp601_config</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="classsp601__config.html">sp601_config</a>();                     <span class="comment">// Declara un constructor</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;};</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">//***************************************************************</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#ac35468256656a04613e24a7e08d81167">  200</a></span>&#160;<a class="code" href="classsp601__config.html">sp601_config</a> <a class="code" href="JarsControl_8h.html#ac35468256656a04613e24a7e08d81167">cfg</a>;<span class="comment">// objeto de sp601_config</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">//*****************************************************************</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">//********************************************************************************************************************  ^</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">//******************************************* Declara clases -----------------------------------------------------------|</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">//******************************************* Define clases  -----------------------------------------------------------|</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">//********************************************************************************************************************  v</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">//******************************************* Define la clase sp601_config *******************************************</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">//Constructor de sp601_config</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">//**************************** Establece los parámetros de RED ******************************************</span></div><div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="classsp601__config.html#a0f455ea81940b646c26beefe54ce475a">  214</a></span>&#160;<a class="code" href="classsp601__config.html#a0f455ea81940b646c26beefe54ce475a">sp601_config::sp601_config</a>()</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">//************************ Define values for network parameters ********************************</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">//IP,MAC,puerto del sp601</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordtype">char</span> sp601_ip[] = <span class="stringliteral">&quot;192.168.1.6&quot;</span>;<span class="comment">//&quot;Para el ROJ:10.10.30.123&quot;;//localizador de mi host en la red</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keywordtype">char</span> sp601_mac[] = <span class="stringliteral">&quot;30:9c:23:d0:1b:ca&quot;</span>;<span class="comment">//Para el ROJ: &quot;00:0a:35:02:05:f2&quot;;//dirección única MAC, que identifica un elemento de la capa de enlace de datos(tarjeta     de red)//Se establece en el main</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordtype">int</span> sp601_port = 9097; <span class="comment">//Para el ROJ: 52428;</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">//IP y puerto del sp601 en string</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordtype">string</span> sp601_ip_string = string(sp601_ip);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">//IP,MAC,puerto de la tarjeta de red serán dados por el bloque</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">//****Guarda los valores de la red establecidos en memoria con su null (ya que estamos en size_t correctito)</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">//Guarda el valor de la ip del sp601</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  SP601_IP=(<span class="keywordtype">char</span> *)malloc(strlen(sp601_ip)+1);<span class="comment">//toma el término null caracter (string literal)</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  memcpy(SP601_IP,sp601_ip,strlen(sp601_ip)+1);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">//Guarda el valor de la mac del sp601</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  SP601_MAC=(<span class="keywordtype">char</span> *)malloc(strlen(sp601_mac)+1);<span class="comment">//</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  memcpy(SP601_MAC,sp601_mac,strlen(sp601_mac)+1);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">//el valor del puerto de la sp601 es guardado en SP601_PORT</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  SP601_PORT = sp601_port;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">//Establece los parámetros de UDP</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  UDP_timeout = 100;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  VERBOSE_MODE = <span class="keyword">true</span>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">//*********************************************************************************************************************</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">//******************************************* Define la clase JARSControl *********************************************</span></div><div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a8a5f2a09daffa77a92e351be46f607a2">  243</a></span>&#160;<a class="code" href="class__JARSControl.html#a8a5f2a09daffa77a92e351be46f607a2">_JARSControl::_JARSControl</a>()</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;{</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        m_NumMarks=2;                  <span class="comment">//2 elementos de la cabecera por eliminar</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        m_MarkRe=-21846;               <span class="comment">//marca para comprobar la cabecera del JARS 2.0</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        m_SizeofBuffer=0;              <span class="comment">// se igualará a m_iSizeNIBuffer</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        m_AcqNIBuffer=NULL;            <span class="comment">//Doble Buffer</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        m_AcqNIDoubleBuffer=NULL;      <span class="comment">//Doble Buffer</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        m_AcqBuffer=NULL;              <span class="comment">//Buffer de adquisición</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        m_nChannelsMask=0;             <span class="comment">//Define los canales a energizar y adquirir</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        m_nCardsMask=0;                <span class="comment">//Se envía al JARS pero no definen canales físicos.Se usó para simular canales</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        VarSetSystem=0;                <span class="comment">//valor tomado para ver el estado de seteado</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        MySP601 = <span class="keyword">new</span> <a class="code" href="classsp601__command.html">sp601_command</a>(); <span class="comment">//Crea un objeto de la clase sp601_command.</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a3373fa4a920c76cf6d66d1668d7b389c">  258</a></span>&#160;<a class="code" href="class__JARSControl.html#a3373fa4a920c76cf6d66d1668d7b389c">_JARSControl::~_JARSControl</a>()</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;{</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  JARSControl.<a class="code" href="class__JARSControl.html#a3a32dd8bf71407e2657267980476ca50">jro_StopAcquisition</a>();</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  printf(<span class="stringliteral">&quot;Terminating program...\n&quot;</span>);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  sleep(1);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  exit(1);<span class="comment">//termina el proceso</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">//Define los parámetros del experimento (MyExpParam) con el parámetro ExpParam introducido en jro_MatchParameters</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">//Define MyExpParam para un objeto de la clase _JARSControl. Este objeto se usará para sincronizar la data en tiempo real</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">//entre threads.</span></div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a6627542a7073fc2a460bc8b5b380f937">  269</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class__JARSControl.html#a6627542a7073fc2a460bc8b5b380f937">_JARSControl::jro_MatchParameters</a>(<a class="code" href="classExpParameters.html">ExpParameters</a>* ExpParam)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;{</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        MyExpParam=ExpParam;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">//Usado en ConfigDataTransfer</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        JARSControl.<a class="code" href="class__JARSControl.html#a3a9bee0735edcc19019ea89c876bb324">MyExpParam</a>=ExpParam; <span class="comment">// agregado para q actualice campo MyExpParam de JARSControl</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;}</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">//Llamará a los buffers de adquisición, doble buffers , al puntero de la función que comenzará el almacenamiento en disco</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">//y establecerá el sistema con SetSystem</span></div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a1dc4dd8d70448789ea8df65ee92eae82">  279</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class__JARSControl.html#a1dc4dd8d70448789ea8df65ee92eae82">_JARSControl::jro_AssignMemory</a>(<a class="code" href="classMemoryManager.html">MemoryManager</a>* MemManager,<span class="keywordtype">void</span> (*ptrClientFunc)(<span class="keywordtype">bool</span> sucess),<a class="code" href="structaddress.html">address</a> host_address)</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{       <span class="comment">//Asigna los buffer de adquisición y memoria</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        m_SizeofBuffer=MemManager-&gt;<a class="code" href="classMemoryManager.html#acdf947edccf307a07382da6ee435d214">m_iSizeNIBuffer</a>;<span class="comment">//tamaño del buffer más grande (sin integraciones)</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        m_AcqBuffer=MemManager-&gt;<a class="code" href="classMemoryManager.html#a1ddfeb3818503fad3b94d8b0fdb1a1fd">m_mAcqBuffer</a>[0];<span class="comment">//buffer de adquisición</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        m_AcqNIBuffer=MemManager-&gt;<a class="code" href="classMemoryManager.html#af53d94ce1836a26f87969064c38900a2">m_nNIBuffer</a>;<span class="comment">//buffer más grande separado en memoria //buffer para threads</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        m_AcqNIDoubleBuffer=MemManager-&gt;<a class="code" href="classMemoryManager.html#a06e03642b89e7f6aa2745efa87e8af7f">m_nNIDoubleBuffer</a>;<span class="comment">//doble buffer más grande separado en memoria//buffer para threads</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        ptrFunc=ptrClientFunc;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">if</span> (!SetSystem(host_address))<span class="comment">//si es seteado correctamente, regresa true//Se puede llamar a métodos que pertenecen a la misma clase dentro de otros métodos</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;           VarSetSystem=1;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        usleep(100000);<span class="comment">/**/</span> <span class="comment">//microsegundos</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">//****** Define el socket y establece las direcciones de puertos ********************************</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">//****** Establece las máscaras (tarjeta y canales) y el filtro***************************************************************</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">//****** Envía los comandos de configuración del JARS:RESET,MODE_OPER,SELECT_RXD,PW_RXD,PROG_RXD,WRT_FILT*******</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">//**** Nos dice si el seteado del sistema se realizó correctamente devolviendo un true ***********</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keywordtype">bool</span> _JARSControl::SetSystem(<a class="code" href="structaddress.html">address</a> host_address)</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;{</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">//-------------- Define el socket y Establece las direcciones de puertos -------------------------------</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">//-------------- Definiremos sockets UDP de GNU Radio --------------------------------------------------</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        MySP601-&gt;init(host_address);<span class="comment">// Inicializar parametros para comunicacion con tarjeta SP601 (tarjeta de bus)(nvia los puetos de la Pc y la SP601 a la SP601)</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="comment">//---------Detecta si las máscaras utilizadas por el objeto JARSControl fueron definidas----------------------------</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">//---------Define parte del paquete (máscara) que será enviado para encender y seleccionar los canales de adquisición.</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">if</span>(!JARSControl.LoadMask()) <span class="comment">// Lee la máscara de programacion del *.racp</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        usleep(50000);<span class="comment">//suspende la ejecución por 50 seg.</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="comment">//----------Utiliza el .jars para establecer las direcciones del filtro---------------------------------------------</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">if</span>(!JARSControl.LoadFilter()) <span class="comment">// Carga el archivo del filtro y define los valores para el AD6620</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        usleep(50000);<span class="comment">/**/</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="comment">//----------- Envía un comando para resetear el JARS ------------------------------------------</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">if</span>(!JARSControl.RESET_CTRL_COMMAND()) <span class="comment">// Resetea el sistema, reinicia todos los FPGA&#39;s</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="comment">//---------- if GENERATE OWN SAMPLING WINDOW=YES del .racp----------------------------------</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">if</span>(MyExpParam-&gt;<a class="code" href="classExpParameters.html#a749ba5fb272f835591296dae9bcccd53">OwnWindow</a>)<span class="comment"></span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">        ////----------  Envía el comando MODE_OPER al JARS ---------------------------------------------</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span>          <span class="keywordflow">if</span>(!JARSControl.MODE_OPER_COMMAND())</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        usleep(50000);<span class="comment">/**/</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">//------------- Envía el comando ELECTION_RXD al JARS -----------------------------------------</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">if</span>(!JARSControl.SELECT_RXD_COMMAND())<span class="comment">//selecciona las tarjetas de adquisición//usado para simular , no procesado</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        usleep(50000);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">//------------- Envía el comando POWER_RXD al JARS -----------------------------------------</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">//Enciende las tarjetas de adquisición y envia las máscaras de los canales</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">if</span>(!JARSControl.PW_RXD_COMMAND()) <span class="comment">// Alimenta los receptores digitales y envia la mascara de los canales seleccionados</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        usleep(50000);<span class="comment">/**/</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="comment">//------------- Envía el comando PROG_RXD al JARS -----------------------------------------</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">if</span>(!JARSControl.PROG_RXD_COMMAND()) <span class="comment">// Envía el comando que permitirá programar el DSP AD6620</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        usleep(50000);<span class="comment">/**/</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="comment">//------------- Relacionado con filter -----------------------------------------</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">if</span>(!JARSControl.WriteFilter()) <span class="comment">// Envía a través del puerto de datos los coeficientes del filtro</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;             <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        usleep(50000);<span class="comment">/**/</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;}</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">//******* Define las máscaras de las tarjetas conectadas y los canales seleccionados ********************************</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">//******* Define parte del paquete que será enviado para encender y seleccionar los canales de adquisición.</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">//JARSControl.m_nChannelsMask: define los canales a energizar y adquirir</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">//JARSControl.m_nCardsMask: se envía al JARS pero no definen canales físicos.Se usó para simular canales</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="keywordtype">bool</span> _JARSControl::LoadMask()</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;{</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="comment">//----------------(Carga de máscara de tarjetas conectadas) Para simular   --------------------------------</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="comment">//****************m_nCardsMask= 11 elementos : ceros = (# tarjetas-1), unos = 11- # ceros *******************</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">for</span>(uint8_t i=0; i&lt;MyExpParam-&gt;<a class="code" href="classExpParameters.html#a6f9185d4fae1038b1bf6672cd5937eef">MyGPParam</a>.<a class="code" href="struct__GlobPParam.html#a4e4bde5e3d036d9e786677cb2000d74a">m_nCards</a>; i++)<span class="comment">//uint8_t = unsigned char</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <span class="keywordflow">if</span> (MyExpParam-&gt;<a class="code" href="classExpParameters.html#a6f9185d4fae1038b1bf6672cd5937eef">MyGPParam</a>.<a class="code" href="struct__GlobPParam.html#ac28bdb8b27ff1dc65f63569f004497f2">Dyn_nCardSequence</a>[i]==0)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                {       <span class="keywordflow">continue</span>;}</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <span class="keywordflow">else</span><span class="comment">//Dyn_nCardSequence = 8bits. Corren un bit a la izquierda &lt;&lt;</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                        <span class="comment">//Adquiere el valor de la máscara de cada tarjeta (m_nCardsMask inicializado en 0 en el constructor)</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                        JARSControl.m_nCardsMask=JARSControl.m_nCardsMask | (1&lt;&lt;(MyExpParam-&gt;<a class="code" href="classExpParameters.html#a6f9185d4fae1038b1bf6672cd5937eef">MyGPParam</a>.<a class="code" href="struct__GlobPParam.html#ac28bdb8b27ff1dc65f63569f004497f2">Dyn_nCardSequence</a>[i]-1));<span class="comment">// | es un bitwise OR</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        JARSControl.m_nCardsMask^=255; <span class="comment">//^ es un XOR .Se realiza un XOR entre: m_nCardsMask y 255 y nos da m_nCardsMask</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        JARSControl.m_nCardsMask=JARSControl.m_nCardsMask | 1792;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        printf(<span class="stringliteral">&quot;Cards mask was loaded\n&quot;</span>);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="comment">//------------------ Carga de mascara de canales seleccionados --------------------------------</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="comment">//******************m_nChannelsMask= 11 elementos : ceros = # canales, unos = 11- # canales *******************</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=(MyExpParam-&gt;<a class="code" href="classExpParameters.html#ad295cabf051467354884f7dc952aced6">MySystemParam</a>.<a class="code" href="struct__SystemParam.html#a2fc99bf00c5551764122a0924a1df888">m_nChannels</a>-1); i&gt;=0; i--)</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <span class="keywordflow">if</span> (MyExpParam-&gt;<a class="code" href="classExpParameters.html#ad295cabf051467354884f7dc952aced6">MySystemParam</a>.<a class="code" href="struct__SystemParam.html#abb9ba419e2dd0853d6d43e1a32f3de7a">m_nNumberOfChannel</a>[i]==0)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                {       <span class="keywordflow">continue</span>;}</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                        JARSControl.m_nChannelsMask=JARSControl.m_nChannelsMask | (1&lt;&lt;(MyExpParam-&gt;<a class="code" href="classExpParameters.html#ad295cabf051467354884f7dc952aced6">MySystemParam</a>.<a class="code" href="struct__SystemParam.html#abb9ba419e2dd0853d6d43e1a32f3de7a">m_nNumberOfChannel</a>[i]-1));</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        JARSControl.m_nChannelsMask^=255;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        JARSControl.m_nChannelsMask=JARSControl.m_nChannelsMask | 1792;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        printf(<span class="stringliteral">&quot;Channels mask was loaded\n&quot;</span>);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">//Lee el archivo .jars que contiene la configuracion de los filtros del DSP.</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">//*********Define el arreglo m_nFilterCoeff donde sus elementos son valores hexadecimales que definen los registros del DSP y establecen los parámetros del filtros (decimació)</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">//Solo define , no  envía.</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">//Pd: Exsite un protocolo entre el FPGA de Programacion y el DSP antes de establecer los valores</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="keywordtype">bool</span> _JARSControl::LoadFilter()</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;{</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordtype">int</span> Adress300=0x300, Adress0=0x0, AdressTemp;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        int16_t CoeffTemp;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        FILE* MyRacpFile;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordtype">char</span> StrTemp[100];</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordtype">char</span>* StrPtr;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        printf(<span class="stringliteral">&quot;%s\n&quot;</span>, MyExpParam-&gt;<a class="code" href="classExpParameters.html#ad295cabf051467354884f7dc952aced6">MySystemParam</a>.<a class="code" href="struct__SystemParam.html#aa49917e56c5325e41bbb7430e092cf46">m_sFilterPath</a>);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        MyRacpFile=fopen(MyExpParam-&gt;<a class="code" href="classExpParameters.html#ad295cabf051467354884f7dc952aced6">MySystemParam</a>.<a class="code" href="struct__SystemParam.html#aa49917e56c5325e41bbb7430e092cf46">m_sFilterPath</a>,<span class="stringliteral">&quot;r&quot;</span>);<span class="comment">//abre la direccion solo lectura</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">if</span>((MyRacpFile)==0)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                printf(<span class="stringliteral">&quot;No filtro ingresado, tomando filtro por defecto\n&quot;</span>);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">for</span>(;;)</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        {       <span class="keywordflow">if</span>(feof(MyRacpFile))<span class="comment">//si llega al final</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                {       fclose(MyRacpFile);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                fgets(StrTemp,100,MyRacpFile);<span class="comment">//lee las 100 primeras variables de MyRacpFile , incluyendo el null-character</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                <span class="keywordflow">if</span> (StrTemp[0]==<span class="charliteral">&#39;3&#39;</span> || StrTemp[0]==<span class="charliteral">&#39; &#39;</span>)</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                {       <span class="keywordflow">if</span> (StrTemp[0]==<span class="charliteral">&#39;3&#39;</span>)</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                AdressTemp=Adress300++; <span class="comment">// primer  bloque de direcciones 300h -&gt; 30Dh</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                        <span class="keywordflow">if</span> (StrTemp[0]==<span class="charliteral">&#39; &#39;</span>)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                AdressTemp=Adress0++;<span class="comment">// segundo bloque de direcciones 000h -&gt; ?</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                        JARSControl.m_nFilterCoeff[JARSControl.m_nCountCoeff++]=(((AdressTemp&gt;&gt;8) &amp; 0x000000FF ) | 0x00000700);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                        JARSControl.m_nFilterCoeff[JARSControl.m_nCountCoeff++]= ((AdressTemp &amp; 0x000000FF) | 0x00000600);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                        StrPtr=strstr(StrTemp, <span class="stringliteral">&quot;-&gt;&quot;</span>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        StrPtr+=2;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                        <span class="keywordflow">if</span> (AdressTemp==0x302)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                        {       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;4; j++)</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                JARSControl.m_nFilterCoeff[JARSControl.m_nCountCoeff++]=(0xFF | (3-j)&lt;&lt;8);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                        {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;4;j++)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                {       <span class="keywordflow">if</span> ((((CoeffTemp=(atoi(StrPtr)&gt;&gt;((3-j)&lt;&lt;3))&amp; 0x00FF)==0) &amp; (j!=3)) &amp;&amp; AdressTemp&gt;=0x300)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                        <span class="keywordflow">else</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                        {       JARSControl.m_nFilterCoeff[JARSControl.m_nCountCoeff]=(CoeffTemp |(3-j)&lt;&lt;8);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                                JARSControl.m_nCountCoeff++;}</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                        }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                <span class="keywordflow">if</span> (StrTemp[0]==<span class="charliteral">&#39;R&#39;</span>) <span class="comment">// Se terminan de leer los coefficientes, creo los ultimos caracteres finales</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                {       JARSControl.m_nFilterCoeff[JARSControl.m_nCountCoeff++]= 0x03 | 0x00000700;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                        JARSControl.m_nFilterCoeff[JARSControl.m_nCountCoeff++]= 0x00 | 0x00000600; <span class="comment">// 300h</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                        JARSControl.m_nFilterCoeff[JARSControl.m_nCountCoeff++]= 0x01 | 0x00000000; <span class="comment">// 0x01</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                        JARSControl.m_nFilterCoeff[JARSControl.m_nCountCoeff++]= 0x03 | 0x00000700;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        JARSControl.m_nFilterCoeff[JARSControl.m_nCountCoeff++]= 0x00 | 0x00000600; <span class="comment">// 301h</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                        JARSControl.m_nFilterCoeff[JARSControl.m_nCountCoeff++]= 0x00 | 0x00000000; <span class="comment">// 0x00</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                        fclose(MyRacpFile);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                        printf(<span class="stringliteral">&quot;Filter was loaded\n&quot;</span>);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;}</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">//--------- Define el payload de RST_CTRL para ser enviado en formato de bytes y lo envía----------</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">//********* Imprime: Nombre de comando,tipo de operación,paquete de dato recibido*******</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keywordtype">bool</span> _JARSControl::RESET_CTRL_COMMAND()</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;{</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordtype">int</span>     cmd_jars=0;<span class="comment">//4 bytes</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordtype">char</span> payload[16]={};</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordtype">size_t</span> size_payload=3;<span class="comment">//24 bits</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="comment">//unsigned long int size_payload=3;</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        printf(<span class="stringliteral">&quot;Reset JARS\n&quot;</span>);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        cmd_jars = <a class="code" href="ExperimentConstants_8h.html#a722e5785aae222e3f5f8f1e48db2e1fa">SYNCHRO</a>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;2)^<a class="code" href="ExperimentConstants_8h.html#ad727a3b9d581739d2e5e88b1716ee1dd">CHIP_ALL</a>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;4)^<a class="code" href="JarsControl_8h.html#a1aa9678f48f9b9661062c9246e64993a">RST_CTRL</a>;<span class="comment">//**define tipo de operación</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;1)^<a class="code" href="ExperimentConstants_8h.html#a764ae24ad191463aa0dc64ea1e105d13">BY_CMD</a>;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;11)^0x00;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        cmd_jars = (int)cmd_jars;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="comment">//Define el payload como 3 bytes de cmd_jars</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <a class="code" href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e">intToBytes</a>(cmd_jars,payload,size_payload);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="comment">//Envía el cmd_array con los bytes configurados para el comando RST_CTRL</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        MySP601-&gt;send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a685f467976dffd4af61e2c198bba3e07">SEND_COMMAND</a>,0,payload,size_payload);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="comment">//da valor a los elementos del buffer payload igual a cero</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        memset(payload,0,strlen(payload));</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;}</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">//------- Define el payload de MODE_OPER para ser enviado en formato de bytes. Esto hace que JARS 2.0 genere su propio win sin el CR------</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">//******************* Imprime: Nombre de comando,tipo de operación,paquete de dato recibido*******</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keywordtype">bool</span> _JARSControl::MODE_OPER_COMMAND()</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;{</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordtype">int</span>     cmd_jars=0;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordtype">char</span> payload[16]={};</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordtype">size_t</span> size_payload=3;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        printf(<span class="stringliteral">&quot;Operation Mode JARS\n&quot;</span>);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        cmd_jars = <a class="code" href="ExperimentConstants_8h.html#a722e5785aae222e3f5f8f1e48db2e1fa">SYNCHRO</a>;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;2)^<a class="code" href="ExperimentConstants_8h.html#ad727a3b9d581739d2e5e88b1716ee1dd">CHIP_ALL</a>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;4)^<a class="code" href="JarsControl_8h.html#a52e278dd9e601652e8ab11b70c53ef6e">MODE_OPER</a>;<span class="comment">//**define tipo de operación</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;1)^<a class="code" href="ExperimentConstants_8h.html#a764ae24ad191463aa0dc64ea1e105d13">BY_CMD</a>;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;11)^0x00;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        cmd_jars = (int)cmd_jars;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="comment">//Define el payload como 3 bytes de cmd_jars</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <a class="code" href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e">intToBytes</a>(cmd_jars,payload,size_payload);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="comment">//Envía el cmd_array con los bytes configurados para el comando MODE_OPER.Imprime los arreglos seleccionados</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        MySP601-&gt;send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a685f467976dffd4af61e2c198bba3e07">SEND_COMMAND</a>,0,payload,size_payload);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="comment">//da valor a los elementos del buffer payload igual a cero</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        memset(payload,0,strlen(payload));</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;}</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">//------------------- Define el payload de ELECTION_RXD para ser enviado en formato de bytes// Simulacion de canales------</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">//******************* Imprime: Nombre de comando,tipo de operación,paquete de dato recibido*******</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="keywordtype">bool</span> _JARSControl::SELECT_RXD_COMMAND()</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;{</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keywordtype">int</span>     cmd_jars=0;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="keywordtype">char</span> payload[16]={};</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keywordtype">size_t</span> size_payload=3;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        printf(<span class="stringliteral">&quot;Select receivers\n&quot;</span>);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        cmd_jars = <a class="code" href="ExperimentConstants_8h.html#a722e5785aae222e3f5f8f1e48db2e1fa">SYNCHRO</a>;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;2)^<a class="code" href="ExperimentConstants_8h.html#ad727a3b9d581739d2e5e88b1716ee1dd">CHIP_ALL</a>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;4)^<a class="code" href="JarsControl_8h.html#ab8923675701bbbb7f51c4e68fac5e588">ELECTION_RXD</a>;<span class="comment">//**define tipo de operación</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;1)^<a class="code" href="ExperimentConstants_8h.html#a764ae24ad191463aa0dc64ea1e105d13">BY_CMD</a>;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;11)^JARSControl.m_nCardsMask;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        cmd_jars = (<span class="keywordtype">int</span>)cmd_jars;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="comment">//Define el payload como 3 bytes de cmd_jars</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <a class="code" href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e">intToBytes</a>(cmd_jars,payload,size_payload);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="comment">//Envía el cmd_array con los bytes configurados para el comando ELECTION_RXD.Imprime los arreglos seleccionados</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        MySP601-&gt;send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a685f467976dffd4af61e2c198bba3e07">SEND_COMMAND</a>,0,payload,size_payload);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="comment">//da valor a los elementos del buffer payload igual a cero</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        memset(payload,0,strlen(payload));</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;}</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">//------------------- Define el payload de POWER_RXD para ser enviado en formato de bytes --------</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">//******************* Imprime: Nombre de comando,tipo de operación,paquete de dato recibido ******</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="keywordtype">bool</span> _JARSControl::PW_RXD_COMMAND()</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;{</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordtype">int</span>     cmd_jars=0;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordtype">char</span> payload[16]={};</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordtype">size_t</span> size_payload=3;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        printf(<span class="stringliteral">&quot;Power the selected receivers\n&quot;</span>);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        cmd_jars = <a class="code" href="ExperimentConstants_8h.html#a722e5785aae222e3f5f8f1e48db2e1fa">SYNCHRO</a>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;2)^<a class="code" href="ExperimentConstants_8h.html#afec22c32aec0b1d3972cdaba0d0ccec7">CHIP_COMAND</a>;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;4)^<a class="code" href="JarsControl_8h.html#a063240a0c681e13158e249f55ac4b750">POWER_RXD</a>;<span class="comment">//**define tipo de operación</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;1)^<a class="code" href="ExperimentConstants_8h.html#a764ae24ad191463aa0dc64ea1e105d13">BY_CMD</a>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;11)^JARSControl.m_nChannelsMask;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        cmd_jars = (<span class="keywordtype">int</span>)cmd_jars;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="comment">//Define el payload como 3 bytes de cmd_jars</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <a class="code" href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e">intToBytes</a>(cmd_jars,payload,size_payload);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="comment">//Envía el cmd_array con los bytes configurados para el comando POWER_RXD.Imprime los arreglos seleccionados</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        MySP601-&gt;send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a685f467976dffd4af61e2c198bba3e07">SEND_COMMAND</a>,0,payload,size_payload);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="comment">//da valor a los elementos del buffer payload igual a cero</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        memset(payload,0,strlen(payload));</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;}</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">//--------------Define el payload de PROG_RXD para ser enviado en formato de bytes--------------</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">//**************Imprime: Nombre de comando,tipo de operación,paquete de dato recibido***********</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="keywordtype">bool</span> _JARSControl::PROG_RXD_COMMAND()</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;{</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordtype">int</span>     cmd_jars=0;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordtype">char</span> payload[16]={};</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordtype">size_t</span> size_payload=3;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        printf(<span class="stringliteral">&quot;Program the selected receivers\n&quot;</span>);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        cmd_jars = <a class="code" href="ExperimentConstants_8h.html#a722e5785aae222e3f5f8f1e48db2e1fa">SYNCHRO</a>;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;2)^<a class="code" href="ExperimentConstants_8h.html#afec22c32aec0b1d3972cdaba0d0ccec7">CHIP_COMAND</a>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;4)^<a class="code" href="JarsControl_8h.html#aefde68a634d66b7039aa56de3fd5301b">PROG_RXD</a>;<span class="comment">//**define tipo de operación</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;1)^<a class="code" href="ExperimentConstants_8h.html#a45ab7a7b703b2e5615905682f51b9e1d">BY_DATA</a>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;11)^JARSControl.m_nCountCoeff;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        cmd_jars = (<span class="keywordtype">int</span>)cmd_jars;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="comment">//Define el payload como 3 bytes de cmd_jars</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <a class="code" href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e">intToBytes</a>(cmd_jars,payload,size_payload);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="comment">//Envía el cmd_array con los bytes configurados para el comando PROG_RXD.Imprime los arreglos seleccionados</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    MySP601-&gt;send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a685f467976dffd4af61e2c198bba3e07">SEND_COMMAND</a>,0,payload,size_payload);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">//da valor a los elementos del buffer payload igual a cero</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        memset(payload,0,strlen(payload));</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;}</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">//***************** Envía los coeficientes de configuracion establecidos en el LoadFilter al SP601 *******************</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">//***************** Recibe el buffer_rcv de respuesta y lo muestra en formato hexadecimal ****************************</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="keywordtype">bool</span> _JARSControl::WriteFilter()</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;{</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordtype">char</span> vector_coeff[256];</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordtype">char</span> payload[4]={};</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordtype">size_t</span> size_vector_coeff=2*(JARSControl.m_nCountCoeff+1);<span class="comment">//envia en char, considera en peso el &#39;0&#39;</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">// Write Filter</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    printf(<span class="stringliteral">&quot;Write Filter\n&quot;</span>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    printf(<span class="stringliteral">&quot;%lu coefficients\n&quot;</span>,size_vector_coeff);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    vector_coeff[0]=0; vector_coeff[1]=0;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">//printf(&quot;%i,%i\n&quot;,vector_coeff[0],vector_coeff[1]);</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">//***Define el vector_coeff el cual será enviado como payload en send***</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;JARSControl.m_nCountCoeff;i++){</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <a class="code" href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e">intToBytes</a>(JARSControl.m_nFilterCoeff[i],payload,2);<span class="comment">//los coeficientes los pasa a bytes (2 partes)</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        vector_coeff[2*i+2]=payload[0];<span class="comment">//guarda la primera parte</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        vector_coeff[2*i+3]=payload[1];<span class="comment">//guarda la segunda parte</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    MySP601-&gt;send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a28b6b130f7a5b8cdbee96bb17ef151af">SEND_FILTER</a>,0,vector_coeff,size_vector_coeff);<span class="comment">//ENVIA EN BYTES</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;}</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">//** Verifica si se habilitó la transferencia de comandos y el configDataTransfer************</span></div><div class="line"><a name="l00581"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a580e2201213c8276faaa2022c28d5a03">  581</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class__JARSControl.html#a580e2201213c8276faaa2022c28d5a03">_JARSControl::jro_InitAcquisition</a>()<span class="comment">//</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;{</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">if</span>(VarSetSystem)<span class="comment">//VarSetSystem=0 está bien</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="comment">//Habilitado la transferencia de datos , nos da true al final</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">if</span>(!JARSControl.HAB_TRANS_COMMAND())  <span class="comment">// Activa los receptores digitales</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">// Inicializa la adquisición, la generación de threads zmq y define el parámetro del puntero de función</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordflow">if</span>(!JARSControl.ConfigDataTransfer())</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  usleep(50000);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;}</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">//----- Define el payload de ENABLE_TRANSF q habilita la tranf de comandos y lo envía al SP601-----------</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">//***** Imprime: Nombre de comando,tipo de operación,paquete de dato recibido*************</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="keywordtype">bool</span> _JARSControl::HAB_TRANS_COMMAND()</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;{</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordtype">int</span>  cmd_jars=0;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordtype">char</span> payload[16]={};</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordtype">size_t</span> size_payload=3;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        printf(<span class="stringliteral">&quot;Enable data transfer\n&quot;</span>);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        cmd_jars = <a class="code" href="ExperimentConstants_8h.html#a722e5785aae222e3f5f8f1e48db2e1fa">SYNCHRO</a>;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;2)^<a class="code" href="ExperimentConstants_8h.html#ad727a3b9d581739d2e5e88b1716ee1dd">CHIP_ALL</a>;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;4)^<a class="code" href="JarsControl_8h.html#ad7e5e3b2ac85d92fe9b81bac2368ca02">ENABLE_TRANSF</a>;<span class="comment">//**define tipo de operación</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;1)^<a class="code" href="ExperimentConstants_8h.html#a764ae24ad191463aa0dc64ea1e105d13">BY_CMD</a>;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;11)^0x00;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        cmd_jars = (int)cmd_jars;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">//Define el payload como 3 bytes de cmd_jars</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <a class="code" href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e">intToBytes</a>(cmd_jars,payload,size_payload);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="comment">//Envía el cmd_array con los bytes configurados para el comando ENABLE_TRANSF.Imprime los arreglos seleccionados</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        MySP601-&gt;send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a685f467976dffd4af61e2c198bba3e07">SEND_COMMAND</a>,0,payload,size_payload);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;}</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">//**************   Método que inicializa la adquisición, la generación de threads zmq y el guardado de la data en disco</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">//**************   La única forma de salir de los bucles de los threads es con una interrupción externa Cnt+c</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="keywordtype">bool</span> _JARSControl::ConfigDataTransfer()</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;{       <span class="keywordtype">float</span> IPP,DH;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NTX, Nchannels, Nsamples_by_channel;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Nsamples;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Nprofilesperblock;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> IPPu;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordtype">char</span> payload[4];</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="comment">//************ Establece parámetros de adquisición del radar para ser enviados **************************************************</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        IPP=(float)(JARSControl.<a class="code" href="class__JARSControl.html#a3a9bee0735edcc19019ea89c876bb324">MyExpParam</a>-&gt;<a class="code" href="classExpParameters.html#a3101e02498e631d62ed0a08bbdd97ce4">MyGRCParam</a>.<a class="code" href="struct__GlobRCParam.html#a3266169525e2a7d77be441ba398a105a">FixRCP</a>.<a class="code" href="struct__RadarControllerParam.html#ae8ac79e57158371f6524e1d160b0d96e">m_fIPP</a>);<span class="comment">//valor de la Ipp del .racp</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        NTX = (<span class="keywordtype">unsigned</span> int)(JARSControl.<a class="code" href="class__JARSControl.html#a3a9bee0735edcc19019ea89c876bb324">MyExpParam</a>-&gt;<a class="code" href="classExpParameters.html#a3101e02498e631d62ed0a08bbdd97ce4">MyGRCParam</a>.<a class="code" href="struct__GlobRCParam.html#a3266169525e2a7d77be441ba398a105a">FixRCP</a>.<a class="code" href="struct__RadarControllerParam.html#a11c44c04097c6e7a89f0f4c1c6b92f2d">m_nNTX</a>);<span class="comment">//numero de ipp por synchr</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        DH = (float)(JARSControl.<a class="code" href="class__JARSControl.html#a3a9bee0735edcc19019ea89c876bb324">MyExpParam</a>-&gt;<a class="code" href="classExpParameters.html#a3101e02498e631d62ed0a08bbdd97ce4">MyGRCParam</a>.<a class="code" href="struct__GlobRCParam.html#abc125c5fd3f6736a5df976d249f7ae42">Dyn_sfAcqDH</a>[0]);<span class="comment">//resolución de altura</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        IPPu = ceil(IPP/DH);<span class="comment">//redondea para arriba //cantidad de DHs por Ipp</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        Nchannels = (<span class="keywordtype">unsigned</span> int)(JARSControl.<a class="code" href="class__JARSControl.html#a3a9bee0735edcc19019ea89c876bb324">MyExpParam</a>-&gt;<a class="code" href="classExpParameters.html#ad295cabf051467354884f7dc952aced6">MySystemParam</a>.<a class="code" href="struct__SystemParam.html#a2fc99bf00c5551764122a0924a1df888">m_nChannels</a>);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        Nsamples_by_channel=(<span class="keywordtype">unsigned</span> int)(JARSControl.<a class="code" href="class__JARSControl.html#a3a9bee0735edcc19019ea89c876bb324">MyExpParam</a>-&gt;<a class="code" href="classExpParameters.html#a3101e02498e631d62ed0a08bbdd97ce4">MyGRCParam</a>.<a class="code" href="struct__GlobRCParam.html#a75b52d816c427cacd56aa202274565cf">Dyn_snAcqNSA</a>[0]);<span class="comment">// número de muestras por canal para un perfil</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        Nsamples = Nchannels*Nsamples_by_channel+1;<span class="comment">//numero de muestra en todos los canales para un perfil</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        Nprofilesperblock = MyExpParam-&gt;<a class="code" href="classExpParameters.html#a6f9185d4fae1038b1bf6672cd5937eef">MyGPParam</a>.<a class="code" href="struct__GlobPParam.html#a0abce01487be8839d4e3ce356246eb51">m_nProfilesperBlock</a>;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordflow">if</span>(IPPu&gt;65536){</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                printf(<span class="stringliteral">&quot;Units of IPP exceeded! %i&quot;</span>,IPPu);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                exit(1);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        }<span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;IPP(Km/units): %.1f, %i\n&quot;</span>,IPP,IPPu);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="keywordflow">if</span>(NTX&gt;65536){</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                printf(<span class="stringliteral">&quot;Number of NTX exceeded! %i&quot;</span>,NTX);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                exit(1);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        }<span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Number of NTX: %i\n&quot;</span>,NTX);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        printf(<span class="stringliteral">&quot;Resolution: %.4f\n&quot;</span>,DH);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="keywordflow">if</span>(Nsamples&gt;4294967296) {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                printf(<span class="stringliteral">&quot;Number of samples per profile exceeded! %i\n&quot;</span>,Nsamples);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                exit(1);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        }<span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Number of Samples per profile: %i\n&quot;</span>,Nsamples);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        printf(<span class="stringliteral">&quot;Number of Profiles per block: %i\n&quot;</span>,Nprofilesperblock);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        printf(<span class="stringliteral">&quot;Number of Samples for all profiles: %i\n&quot;</span>,Nsamples*Nprofilesperblock);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="comment">//IPP=1000</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="comment">//payload[0]=0x03;payload[1]=0x20</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        payload[0]=(char)(IPPu&gt;&gt;8); payload[1]=(char)(IPPu);    <span class="comment">// Load IPPunits</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="comment">//payload[2]= 0x00 ; payload[3]=0x96</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        payload[2]=(char)(NTX&gt;&gt;8); payload[3]=(char)(NTX);      <span class="comment">// Load NTX</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="comment">//payload[4]=0x00 ; payload[5]= 0x00</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        payload[4]=(char)(Nsamples&gt;&gt;24); payload[5]=(char)(Nsamples&gt;&gt;16);       <span class="comment">// Load SamplesperProfile</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="comment">//payload[6]=0x03 ; payload[7]=0xE9</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        payload[6]=(char)(Nsamples&gt;&gt;8); payload[7]=(char)(Nsamples);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        MySP601-&gt;send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a55636b09cf88b31facd828042757e8cd">DATA_LOOPS</a>,0,payload,8); <span class="comment">// 2 bytes for IPPunits, 2 bytes for NTX, 4 bytes for SamplesperProfile</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">//************************Se crean threads paralelos en el proceso JARSControl que realizan las tareas de Internalx***********************</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">//Ejecuta la parte del socket para la recepcion de paquetes</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="keywordflow">if</span>(pthread_create(&amp;JARSControl._thread_rcv, NULL, JARSControl.<a class="code" href="class__JARSControl.html#a643f89d471e0690716b0aae9cb39b10f">InternalRcvFunc</a>, <span class="keyword">this</span>)==0)</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                printf(<span class="stringliteral">&quot;Now the packets receiver thread starts\n&quot;</span>);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">if</span>(pthread_create(&amp;JARSControl._thread_jars, NULL, JARSControl.<a class="code" href="class__JARSControl.html#a6c19d395de3d648bc66f2b7f886fe10c">InternalThreadEntryFunc</a>, <span class="keyword">this</span>)==0)</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                printf(<span class="stringliteral">&quot;Now the block constructor thread starts\n&quot;</span>);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="keywordflow">if</span>(pthread_create(&amp;JARSControl._thread_jars_rcv, NULL, JARSControl.<a class="code" href="class__JARSControl.html#a7ee41ba1eaf9a77999e55fcda1660cf2">InternalCallbackFunc</a>, <span class="keyword">this</span>)==0)<span class="comment">//define el puntero</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        {</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;           printf(<span class="stringliteral">&quot;Now the block save thread s_thread_configtarts\n&quot;</span>);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;           <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        {</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        }</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;}</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">//verifica si se detuvo la adquisicion mediante el envio del comando de deshabilitacion y reseteo del JARS</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">//Envia un request de cancelación al thread de origen de bloques</span></div><div class="line"><a name="l00686"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a3a32dd8bf71407e2657267980476ca50">  686</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class__JARSControl.html#a3a32dd8bf71407e2657267980476ca50">_JARSControl::jro_StopAcquisition</a>()</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;{</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keywordflow">if</span>(!JARSControl.DESHAB_TRANS_COMMAND())<span class="comment">//Envía el comando de deshabilitación</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordflow">if</span>(!JARSControl.RESET_CTRL_COMMAND()) <span class="comment">// Resetea el sistema, reincia todos los FPGA&#39;s</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="comment">// Terminating acquisition thread</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        printf(<span class="stringliteral">&quot;Terminating acquisition thread...\n&quot;</span>);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        pthread_cancel(JARSControl._thread_jars);       <span class="comment">// Sending cancellation request//cancela el thread por si queda data guardada</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        sleep(0.5);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;}</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">//--- Define un payload con comando 0x00 y el payload de DISABLE_TRANSF para ser enviado en formato de bytes-----------</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">//comando 0x00: crea el arreglo cmd_array.NO crea  info_Str,buffer_rcv</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">//comando DISABLE_TRANSF: genera el cmd_array,info_str, recive en el buffer_rcv,imprime el nombre de comando, estdo de comando de config y buffer_rcv.NO imprime el cmd_array</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">//***** Espera la finalizacion de la adquisición y envia el comando de deshabilitación.</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="keywordtype">bool</span> _JARSControl::DESHAB_TRANS_COMMAND()</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;{</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordtype">int</span>  cmd_jars=0;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="keywordtype">char</span> payload[16]={};</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordtype">size_t</span> size_payload=3;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="comment">// ********close all the threads</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="comment">// ********Espera a que el hilo _thread_rcv acabe (termina el hilo _thread_rcv y devuelve NULL a nuestro hilo de trabajo)</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="comment">//Al terminar ese thread, continuará esta parte.Los demás threads continuarán</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        pthread_join(_thread_rcv, NULL);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="comment">//************ Previous command to exit JARS from acquisition loop</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="comment">//sp601_command(&#39;NOOP&#39;,0,int_to_bytearray(0,3))</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="comment">//************ Crea el payload antes del comando de deshabilitación ***********</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="comment">//************ Por qué envía 0x00</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        cmd_jars = <a class="code" href="ExperimentConstants_8h.html#a722e5785aae222e3f5f8f1e48db2e1fa">SYNCHRO</a>;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;2)^<a class="code" href="ExperimentConstants_8h.html#ad727a3b9d581739d2e5e88b1716ee1dd">CHIP_ALL</a>;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;4)^0x00;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;1)^<a class="code" href="ExperimentConstants_8h.html#a764ae24ad191463aa0dc64ea1e105d13">BY_CMD</a>;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;11)^0x00;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        cmd_jars = (int)cmd_jars;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="comment">//Define el payload como 3 bytes de cmd_jars</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <a class="code" href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e">intToBytes</a>(cmd_jars,payload,size_payload);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="comment">//Envía el cmd_array con los bytes configurados para el comando NOOP</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        MySP601-&gt;send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a7316843e88740cd819c6427a7f833df6">NOOP</a>,0,payload,size_payload); <span class="comment">// No muestra nada</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        usleep(50000);<span class="comment">//suspende la ejecución por 0.5 segundos</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="comment">//********** Crea el payload oara el comando de deshabilitacion *****************</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        printf(<span class="stringliteral">&quot;Disabling data transfer...\n&quot;</span>);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        cmd_jars = <a class="code" href="ExperimentConstants_8h.html#a722e5785aae222e3f5f8f1e48db2e1fa">SYNCHRO</a>;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;2)^<a class="code" href="ExperimentConstants_8h.html#ad727a3b9d581739d2e5e88b1716ee1dd">CHIP_ALL</a>;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;4)^<a class="code" href="JarsControl_8h.html#aacac2365f297d20c92dac6c32a87c6a3">DISABLE_TRANSF</a>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;1)^<a class="code" href="ExperimentConstants_8h.html#a764ae24ad191463aa0dc64ea1e105d13">BY_CMD</a>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        cmd_jars = (cmd_jars&lt;&lt;11)^0x00;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        cmd_jars = (int)cmd_jars;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="comment">//Define el payload como 3 bytes de cmd_jars</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <a class="code" href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e">intToBytes</a>(cmd_jars,payload,size_payload);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="comment">//Envía el cmd_array con los bytes configurados para el comando DISABLE_TRANSF</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        MySP601-&gt;send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a685f467976dffd4af61e2c198bba3e07">SEND_COMMAND</a>,0,payload,size_payload);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;}</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">//this pointer: puntero al OBJETO del método que lo llama</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">//**************this = Objeto de InternalRcvFunc**************************</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">//Ejecuta el método InternalRcv: Crea el socket zmq que almacena los paquetes de datos adquiridos,por marca,y los envía</span></div><div class="line"><a name="l00748"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a643f89d471e0690716b0aae9cb39b10f">  748</a></span>&#160;<span class="keywordtype">void</span> *<a class="code" href="class__JARSControl.html#a643f89d471e0690716b0aae9cb39b10f">_JARSControl::InternalRcvFunc</a>(<span class="keywordtype">void</span> * This) {</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        ((<a class="code" href="class__JARSControl.html">_JARSControl</a> *)This)-&gt;InternalRcv(); <span class="keywordflow">return</span> NULL;<span class="comment">//This es el puntero del objeto de la clase JARSControl</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;}</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">//******** Crea un soquet ZMQ_PUSH, recibe bytes del socket fpga y los envía a través del socket ZMQ al cliente definido en InternalThreadEntry ******************</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">//zmq solo almacena la data adquirida del buffer de la tarjeta de red para que no se pierda en un espacio de memoria de la RAM</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">//********************* Comprueba que la marca del bloque es la correcta verificando así que el bloque de llegada es el correcto *****************</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">//Crea el socket zmq que almacena los paquetes de datos adquiridos, por marca, y los envía</span></div><div class="line"><a name="l00757"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a6e97ca0b4324bc1af443e36b28bb1d3e">  757</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class__JARSControl.html#a6e97ca0b4324bc1af443e36b28bb1d3e">_JARSControl::InternalRcv</a>(){</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordtype">char</span> buffer_rcv[1472];<span class="comment">//buffer donde se guardará el mensaje que viene</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="comment">// Create server socket</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        zmq::socket_t server (<a class="code" href="JicaHeader_8h.html#acfa1e2b991d398ea406cdd6198bb2ee6">context</a>, ZMQ_PUSH);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        server.bind(<span class="stringliteral">&quot;ipc://5559&quot;</span>);<span class="comment">//Revisar si está bien declarado y si es el correcto protocolo inproc.</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        uint16_t prev_mark = 0, new_mark, dif_mark;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        printf(<span class="stringliteral">&quot;Acquisition threads begin...\n&quot;</span>);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keywordflow">for</span> (;;) {</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                <span class="comment">//pthread_mutex_lock(&amp;estado_mutex);</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                <span class="comment">// Recibir paquetes de datos en formato de bytes (0x41,0x42,0xaa,0xaa,0xaa,0xam,dat_0[])</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                ssize_t size_rcv_buf=MySP601-&gt;receive(buffer_rcv);<span class="comment">//Recive por el socket UDP//paquete de 1472 bytes</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                <span class="comment">//Por cada bloque UDP se genera una marca.Esta marca es de 32bits y el último es el contador.</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                new_mark = (int)(0x0F &amp; buffer_rcv[5]);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                dif_mark = new_mark - prev_mark;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                <span class="comment">// Review the correct sequence of the marks, acumulacion de subperfiles</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                <span class="comment">//(=1), siguiente marca;(=0),UDP en el mismo windows;(=0),recién comienza</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                <span class="keywordflow">if</span>((dif_mark == 1) || (dif_mark == 65521) || (dif_mark == 0) || (prev_mark==0)){</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                }</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <span class="keywordflow">else</span>{</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                        printf(<span class="stringliteral">&quot;Error..\n&quot;</span>);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                        printf(<span class="stringliteral">&quot;Lost packet: %i\n&quot;</span>, dif_mark);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                        printf(<span class="stringliteral">&quot;Mark_prev: %x\n&quot;</span>, prev_mark);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                        printf(<span class="stringliteral">&quot;Mark_new: %x\n&quot;</span>, new_mark);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                prev_mark = new_mark;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                <span class="comment">//*****************Inicializa y envía un mensaje por el socket ZMQ *****************************************</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                <span class="comment">//inicializa un mensaje de size_rcv_buf bytes</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                zmq::message_t reply(size_rcv_buf);</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                <span class="comment">//.data:retrieve pointer to message content</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                <span class="comment">//Copia el mensaje que llega en reply.data()</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                memcpy((<span class="keywordtype">void</span> *) reply.data(), buffer_rcv, size_rcv_buf);<span class="comment">//void * memset ( void * ptr, int value, size_t num );</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                server.send(reply);<span class="comment">//envía el mensaje de llegada por el soquet ZMQ</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        }</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;}</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">//**************this = Objeto de InternalThreadEntryFunc**************************</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">//Ejecuta el método InternalThreadEntry:almacena la cantidad de perfile por bloque*****************************</span></div><div class="line"><a name="l00797"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a6c19d395de3d648bc66f2b7f886fe10c">  797</a></span>&#160;<span class="keywordtype">void</span> *<a class="code" href="class__JARSControl.html#a6c19d395de3d648bc66f2b7f886fe10c">_JARSControl::InternalThreadEntryFunc</a>(<span class="keywordtype">void</span> * This) {</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        ((<a class="code" href="class__JARSControl.html">_JARSControl</a> *)This)-&gt;InternalThreadEntry(); <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;}</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">/*************** Tarea que adquiere los paquetes y convierte a perfiles hasta completar un bloque ************************/</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">//**************Almacena la data por cada sync (NTX) en TempAcqNIDoubleBuffer hasta llegar al total de perfiles por bloque</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">//**** Al llegar a la cantidad de perfiles por bloque lo guarda en TempAcqNIBuffer y envía &quot;Block received&quot; por el socket.</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">//**** Nos da el tiempo de demora entre bloques</span></div><div class="line"><a name="l00805"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a57bb6d2e0d1c5e18bd101de314651e8c">  805</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class__JARSControl.html#a57bb6d2e0d1c5e18bd101de314651e8c">_JARSControl::InternalThreadEntry</a>(){</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        uint16_t prev_mark = 0, new_mark, dif_mark;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">int</span> num_prof=1;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">int</span> cnt_subprof=0;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">int</span> ind_buffer=0;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        uint16_t buffer_rcv_2[1472];</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        ssize_t size_rcv_buf;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="keywordtype">int</span> size_rcv_buf_2;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordtype">long</span> TmInit,TmFinal;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="comment">// Create client socket</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        zmq::socket_t client (<a class="code" href="JicaHeader_8h.html#acfa1e2b991d398ea406cdd6198bb2ee6">context</a>, ZMQ_PULL);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        client.connect(<span class="stringliteral">&quot;ipc://5559&quot;</span>);<span class="comment">//Revisar si está bien declarado y si es el correcto protocolo inproc.</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        zmq::message_t msg;<span class="comment">//inicializa el objeto mensaje msg de zmq</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        std::string msg_recv;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        zmq::socket_t server (<a class="code" href="JicaHeader_8h.html#acfa1e2b991d398ea406cdd6198bb2ee6">context</a>, ZMQ_PUSH);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        server.bind(<span class="stringliteral">&quot;ipc://5557&quot;</span>);</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        uint16_t* TempAcqNIBuffer=(uint16_t*)JARSControl.m_AcqNIBuffer;<span class="comment">//definido en jro_AssignMemory</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        uint16_t* TempAcqNIDoubleBuffer=(uint16_t*)JARSControl.m_AcqNIDoubleBuffer;<span class="comment">//definido en jro_AssignMemory</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordflow">for</span>(;;){</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                        client.recv(&amp;msg);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                        msg_recv = string(static_cast&lt;char*&gt;(msg.data()), msg.size());<span class="comment">//transforma data de tipo char a string</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                        size_rcv_buf = msg.size();<span class="comment">//tamaño con cabecera</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                        <span class="comment">// Reconstruir datos en formato de 16 bits (Real e Imaginario)</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                        size_rcv_buf_2 = (size_rcv_buf-2)/2;<span class="comment">//le resta dos bytes de la cabecera (0x41 0x42) (/2) ya q lo almacena en 16bits//numero de dieciseis avos</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;size_rcv_buf_2;i++){</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                        <span class="comment">//lo cambia de posicion para que sea visto en display// el FPGA lo vuelve a cambiar a la posición correcta</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                                buffer_rcv_2[i] = ((0x00FF &amp; msg_recv[2*i+3])&lt;&lt;8) + (0x00FF &amp; msg_recv[2*i+2]);<span class="comment">//no toma los dos primeros ya q estan borrados</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                        }</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                        new_mark = (int)(0x0F &amp; msg_recv[5]);</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                        dif_mark = new_mark - prev_mark;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                        <span class="comment">// Review the correct sequence of the marks, acumulacion de subperfiles</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                        <span class="keywordflow">if</span>((dif_mark == 1) || (dif_mark == 65521) || (dif_mark == 0) || (prev_mark==0)){</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                        <span class="comment">//revisar si hay cambio de marca valida, para reiniciar el contador de subperfiles</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                        <span class="keywordflow">if</span>(dif_mark==1 || (dif_mark == 65521)){</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                <span class="keywordflow">if</span>(num_prof == (MyExpParam-&gt;<a class="code" href="classExpParameters.html#a6f9185d4fae1038b1bf6672cd5937eef">MyGPParam</a>.<a class="code" href="struct__GlobPParam.html#a0abce01487be8839d4e3ce356246eb51">m_nProfilesperBlock</a>/MyExpParam-&gt;<a class="code" href="classExpParameters.html#a3101e02498e631d62ed0a08bbdd97ce4">MyGRCParam</a>.<a class="code" href="struct__GlobRCParam.html#a3266169525e2a7d77be441ba398a105a">FixRCP</a>.<a class="code" href="struct__RadarControllerParam.html#a11c44c04097c6e7a89f0f4c1c6b92f2d">m_nNTX</a>)){<span class="comment">//perfiles por bloque por cada ipp</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                                    std::string msgToClient(<span class="stringliteral">&quot;Block received&quot;</span>);<span class="comment">//define msgToCliente</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                                    memcpy((uint16_t *)TempAcqNIBuffer,(uint16_t *)TempAcqNIDoubleBuffer,ind_buffer*2);<span class="comment">//copia los datagramas por bloque y al revés, con solo la primera cabecera,guardados en TempAcqNIDoubleBuffer a TempAcqNIBuffer</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                                                                                                                                                                                                                   <span class="comment">// 0xaa 0xaa 0xam 0xaa Dato [1] Dato[0]</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                                    zmq::message_t reply(msgToClient.size()+1);<span class="comment">//crea el mensaje tipo ZMQ de 14 bytes+1 null</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                                    memcpy((<span class="keywordtype">void</span> *) reply.data(), (msgToClient.c_str()), msgToClient.size()+1);<span class="comment">//c_string : string+&#39;\0&#39;//char *str = s; // error: can&#39;t initialize a char* from a string // const char *str = s.c_str(); // ok</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                                                                                                                                                                                                 <span class="comment">//Se debe sumar +1 al final</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                                    server.send(reply);<span class="comment">//envía el mensaje &quot;Block received&quot; en formato const char []</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                                    num_prof=1;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                                    ind_buffer=0;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                                                }</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                                                <span class="keywordflow">else</span> num_prof = num_prof + 1;<span class="comment">//recibirá un bloque con dos marcas diferentes</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                                                cnt_subprof=0;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                                }</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                                <span class="comment">/**************Almacenar data recibida en TempAcqNIDobleBuffer con la cabecera aa aa aa am********************/</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                                <span class="keywordflow">if</span>(cnt_subprof==0){ <span class="comment">// El primer perfil del bloque con cabecera pero sin 0x41 y 0x42</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                                        memcpy((uint16_t *)(TempAcqNIDoubleBuffer+ind_buffer),buffer_rcv_2,size_rcv_buf-2);</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                        ind_buffer += size_rcv_buf_2;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                                }</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                                <span class="keywordflow">else</span>{<span class="comment">///a partir del SEGUNDO perfil guarda el dato adquirido sin cabecera  (quita toda la cabecera . incluso la marca)</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment"></span>                                        memcpy((uint16_t *)(TempAcqNIDoubleBuffer+ind_buffer),(uint16_t *)(buffer_rcv_2+2),size_rcv_buf-6);<span class="comment">//buffer_rcv_2+2 le sacan los dos shorts de cabecera , size_rcv_buf-6 eliminida los 6 bytes de cabecera en el tamaño</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                                        ind_buffer += size_rcv_buf_2-2;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                                }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                cnt_subprof++;<span class="comment">//contador de paquetes (muestras)</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                        }</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                        <span class="keywordflow">else</span>{</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                                printf(<span class="stringliteral">&quot;Lost packet: %i\n&quot;</span>, dif_mark);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                                printf(<span class="stringliteral">&quot;Mark_prev: %x\n&quot;</span>, prev_mark);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                                printf(<span class="stringliteral">&quot;Mark_new: %x\n&quot;</span>, new_mark);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                                JARSControl.DESHAB_TRANS_COMMAND();</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                                exit(1);</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                                }</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                        prev_mark = new_mark;     <span class="comment">// actualizar la marca anterior</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        }</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;};</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">//********** Ejecuta el método InternalCallback mediante el objeto seleccionado por this.</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">//el cual :Guarda la data adquirida sin marca en m_AcqBuffer[0] y ordena el comienzo del procesamiento y guardado en disco</span></div><div class="line"><a name="l00883"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a7ee41ba1eaf9a77999e55fcda1660cf2">  883</a></span>&#160;<span class="keywordtype">void</span> *<a class="code" href="class__JARSControl.html#a7ee41ba1eaf9a77999e55fcda1660cf2">_JARSControl::InternalCallbackFunc</a>(<span class="keywordtype">void</span> * This) {</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        ((<a class="code" href="class__JARSControl.html">_JARSControl</a> *)This)-&gt;InternalCallback(); <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;}</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">//Guarda la data adquirida sin marca en m_AcqBuffer[0] y ordena el comienzo del procesamiento y guardado en disco</span></div><div class="line"><a name="l00888"></a><span class="lineno"><a class="line" href="class__JARSControl.html#a96cc4161869c0e963d31fd2d462f7f01">  888</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class__JARSControl.html#a96cc4161869c0e963d31fd2d462f7f01">_JARSControl::InternalCallback</a>(){</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="keywordtype">bool</span> ClientValue=<span class="keyword">false</span>;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordtype">long</span> TmInit,TmFinal;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="comment">// Create client socket</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        zmq::socket_t client (<a class="code" href="JicaHeader_8h.html#acfa1e2b991d398ea406cdd6198bb2ee6">context</a>, ZMQ_PULL);</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        client.connect(<span class="stringliteral">&quot;ipc://5557&quot;</span>);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        zmq::message_t msg;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        std::string msg_recv;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        uint16_t* TempAcqNIBuffer=(uint16_t*)JARSControl.m_AcqNIBuffer;<span class="comment">//Puntero al buffer grande NI,JARSControl.m_AcqNIBuffer,con la data adquirida previamente por            el thread InternalThreadEntry</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        uint16_t prev_mark;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="keywordflow">for</span>(;;){</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                client.recv(&amp;msg);<span class="comment">//recive el mensaje &quot;Block received&quot;</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                msg_recv = string(static_cast&lt;char*&gt;(msg.data()), msg.size());</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                <span class="comment">//guarda la marca para su verificación ya que adquiere el thread anterior y guarda en este thread &quot;simultaneamente&quot;</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                prev_mark = TempAcqNIBuffer[1];<span class="comment">//TempAcqNIBuffer[1]= 0xam 0xaa</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                <span class="keywordflow">if</span>(TempAcqNIBuffer[0]==(0xFFFF&amp;JARSControl.m_MarkRe)){<span class="comment">//m_MarkRe=-21846//1010101010101010(0xaa 0xaa)</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                        ClientValue=<span class="keyword">true</span>;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                        JARSControl.RemoveMark();</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                        <span class="comment">//*******verifica si el bloque adquirido del anterior thread es correcto</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                        <span class="keywordflow">if</span>(TempAcqNIBuffer[1]!=prev_mark){ <span class="comment">// Error producido cuando los datos se actualizan al escribir en disco</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                printf(<span class="stringliteral">&quot;Incorrect data\n&quot;</span>);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                                JARSControl.DESHAB_TRANS_COMMAND(); <span class="comment">//*******FALTA</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                                <span class="keywordtype">bool</span> flagError= <span class="keyword">true</span>;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                exit(1);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                        }</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                }</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                <span class="keywordflow">else</span>{</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                        ClientValue = <span class="keyword">false</span>;<span class="comment">//no save data (atributo que se define para la función MyCallbackFunction</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                }</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                <span class="comment">//*********ptrFunc: Arreglo de funciones definido en main que inicializa el procesamiento y lo guarda en disco con fwrite</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                <span class="comment">//Tiempo de demora de procesamiento y guardado en disco de la data adquirida</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                <span class="keywordflow">if</span>(JARSControl.<a class="code" href="class__JARSControl.html#a83109c7d938a17dcd5344b8984489490">ptrFunc</a>!=NULL)</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                        JARSControl.<a class="code" href="class__JARSControl.html#a83109c7d938a17dcd5344b8984489490">ptrFunc</a>(ClientValue);<span class="comment">//ClientValue = true da inicio a la función MyCallbackFunction.</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                <span class="comment">//Tiempo que se demora en adquirir y guardar(jicaheader-fwite)</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                printf(<span class="stringliteral">&quot;Almacenamiento en disco en %ld milisegundos\n&quot;</span>,TmFinal-TmInit);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        client.close();<span class="comment">//The zmq_close() function shall destroy the socket referenced by the socket argument</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;};</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">//*********** Remueve la marca y guarda la data adquirida por bloque en *TempAcqBuffer=*m_AcqBuffer[0] sin marca</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="keywordtype">void</span> _JARSControl::RemoveMark()</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;{</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        complex&lt;short&gt;* TempAcqNIBuffer=(complex&lt;short&gt;*)m_AcqNIBuffer;<span class="comment">//buffer separado con marca</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        complex&lt;short&gt;* TempAcqBuffer=(complex&lt;short&gt;*)m_AcqBuffer;<span class="comment">//buffer separado sin marca</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="keywordtype">int</span> Samples=MyExpParam-&gt;<a class="code" href="classExpParameters.html#ad295cabf051467354884f7dc952aced6">MySystemParam</a>.<a class="code" href="struct__SystemParam.html#a19a6cf532b877478838544bb8471c53b">m_nSamples</a>;<span class="comment">//NSA de .racp</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordtype">int</span> Channels=MyExpParam-&gt;<a class="code" href="classExpParameters.html#ad295cabf051467354884f7dc952aced6">MySystemParam</a>.<a class="code" href="struct__SystemParam.html#a2fc99bf00c5551764122a0924a1df888">m_nChannels</a>;<span class="comment">//canales del .racp</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="keywordtype">int</span> NTX=MyExpParam-&gt;<a class="code" href="classExpParameters.html#a3101e02498e631d62ed0a08bbdd97ce4">MyGRCParam</a>.<a class="code" href="struct__GlobRCParam.html#a3266169525e2a7d77be441ba398a105a">FixRCP</a>.<a class="code" href="struct__RadarControllerParam.html#a11c44c04097c6e7a89f0f4c1c6b92f2d">m_nNTX</a>;<span class="comment">//IPPs por synchr del .racp</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keywordtype">int</span> Profiles=MyExpParam-&gt;<a class="code" href="classExpParameters.html#ad295cabf051467354884f7dc952aced6">MySystemParam</a>.<a class="code" href="struct__SystemParam.html#ab86ec2eb0141deaa322b4d78c975dd25">m_nProfiles</a>;<span class="comment">//ACQUIRED PROFILES del .racp</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="keywordtype">int</span> jump=Samples*Channels*NTX;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordtype">size_t</span> jumpInBytes= jump*4;<span class="comment">//1 muestra en formato complex&lt;short&gt; tiene 4 bytes</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="comment">//*******************Copia lo que hay en el buffer grande total m_nNIBuffer en en AcqBuffer[0]************</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="comment">//************Copia desde la posición 1 de TempAcqNIBuffer , que es de donde comienza la data adquirida****</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;Profiles/NTX;i++)<span class="comment">//perfiles adquiridos en cada synchro</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                memcpy(&amp;TempAcqBuffer[i*jump],&amp;TempAcqNIBuffer[i*(jumpInBytes+m_NumMarks)+m_NumMarks],jumpInBytes);</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <span class="keywordflow">return</span>;<span class="comment">//guardo los perfiles con tamaño jump (ChHP) hasta completar un bloque</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;}</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">//********************************************************************************************************************</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">//******************************************* Define clase sp601_command *********************************************</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">//Array of structures: {const char *name,char val,char size,bool ack}</span></div><div class="line"><a name="l00949"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#aaef9d5a8a094f6486db3073c3ee31464">  949</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structjars__cmd.html">jars_cmd</a> <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152">JARS_CMD</a>[] = {</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        [<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a7316843e88740cd819c6427a7f833df6">NOOP</a>]                  =               {<span class="stringliteral">&quot;NOOP&quot;</span>,0,0,<span class="keyword">false</span>},                     <span class="comment">// No effect or ACK</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        [<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152abff6b2d1371663911c20d04738892bfd">SET_SP601_IP</a>]          =               {<span class="stringliteral">&quot;SET_SP601_IP&quot;</span>,1,4,<span class="keyword">true</span>},              <span class="comment">// Set IP address for SP601. No ACK since we might not be able to see it if                                                                                             the COMMS_IP has not been setup</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        [<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a578a2dc0f32dacf50c510f7009c12d1f">SET_SP601_PORT</a>]        =               {<span class="stringliteral">&quot;SET_SP601_PORT&quot;</span>,2,2,<span class="keyword">true</span>},            <span class="comment">// Set Port address for SP601</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        [<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a9dd105b07676790bd963c49f607588b9">GET_SP601_MAC</a>]         =               {<span class="stringliteral">&quot;GET_SP601_MAC&quot;</span>,3,6,<span class="keyword">true</span>},             <span class="comment">// Get MAC address for SP601. Note that we don&#39;t get to SET this. It&#39;s done                                                                                             in HW through DIP switches</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        [<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152abd7b2f700ca4ef2b11180557059e6bbd">SET_COMMS_IP</a>]          =               {<span class="stringliteral">&quot;SET_COMMS_IP&quot;</span>,4,4,<span class="keyword">true</span>},              <span class="comment">// Set IP address for communication PC</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        [<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a57446329e1b880f1e79096d89ca90abf">SET_COMMS_PORT</a>]        =               {<span class="stringliteral">&quot;SET_COMMS_PORT&quot;</span>,5,2,<span class="keyword">true</span>},            <span class="comment">// Set Port address for communication PC</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        [<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152aedb06bfaf37d18638b99cabc860b5c4b">SET_COMMS_MAC</a>]         =               {<span class="stringliteral">&quot;SET_COMMS_MAC&quot;</span>,6,6,<span class="keyword">true</span>},             <span class="comment">// Set MAC address for communication PC</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        [<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152af2fb94d1fd1739ad68220e57882efa23">GET_VALUE</a>]             =               {<span class="stringliteral">&quot;GET_VALUE&quot;</span>,8,0,<span class="keyword">false</span>},                <span class="comment">// Get different values stored in FPGA</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        [<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a55636b09cf88b31facd828042757e8cd">DATA_LOOPS</a>]            =               {<span class="stringliteral">&quot;DATA_LOOPS&quot;</span>,63,8,<span class="keyword">false</span>},              <span class="comment">// Up to 16-bits to loop packet sending. 16-bit (effective 14 bits in HW)                                                                                               for packet size. This is used to test for bandwidth in the Gigabit Connection</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        [<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a685f467976dffd4af61e2c198bba3e07">SEND_COMMAND</a>]          =               {<span class="stringliteral">&quot;SEND_COMMAND&quot;</span>,64,3,<span class="keyword">false</span>},            <span class="comment">// Up to 16-bits (effective 14 bits in HW) to request #32-bit words to start                                                                                            burst data transfer. Note, due to IP packet packaging, should be no more                                                                                                than 367 words</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        [<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a977ee7b118a6816596e05f1c5c6221f2">CHECK_ACK</a>]             =               {<span class="stringliteral">&quot;CHECK_ACK&quot;</span>,65,1,<span class="keyword">false</span>},               <span class="comment">// ack-command</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        [<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a28b6b130f7a5b8cdbee96bb17ef151af">SEND_FILTER</a>]           =               {<span class="stringliteral">&quot;SEND_FILTER&quot;</span>,66,0,<span class="keyword">false</span>}              <span class="comment">// Send filter</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;};</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno"><a class="line" href="classsp601__command.html#ab96dc6299f8ee6dd7bde84584ea72d5f">  964</a></span>&#160;<a class="code" href="classsp601__command.html#ab96dc6299f8ee6dd7bde84584ea72d5f">sp601_command::sp601_command</a>()</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;{}</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno"><a class="line" href="classsp601__command.html#a4acdc1e7593b27a8831b0bea12e27aa5">  967</a></span>&#160;<a class="code" href="classsp601__command.html#a4acdc1e7593b27a8831b0bea12e27aa5">sp601_command::~sp601_command</a>()</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;{}</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">//***** Define el socket y establece las direcciones de los puertos, la MAC y la IP de la Pc y el SP601**********************</span></div><div class="line"><a name="l00970"></a><span class="lineno"><a class="line" href="classsp601__command.html#a00e7747470750f26ba33b69b9a1b028b">  970</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classsp601__command.html#a00e7747470750f26ba33b69b9a1b028b">sp601_command::init</a>(<a class="code" href="structaddress.html">address</a> host_address)</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;{</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="comment">//****************** Convierte de string a char* la ip y mac local      </span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="keywordtype">int</span> mac_size= ((host_address.<a class="code" href="structaddress.html#a47c83523d9cc06ed386f29e5fcd5eeda">d_mac_block</a>).<a class="code" href="structjars__cmd.html#a2ac9bbc25760e1a29a170271d68ea390">size</a>());</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="keywordtype">char</span> mac_array_char [mac_size+1]={};</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        strcpy (mac_array_char,(host_address.<a class="code" href="structaddress.html#a47c83523d9cc06ed386f29e5fcd5eeda">d_mac_block</a>).c_str());</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        </div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="keywordtype">int</span> ip_size= ((host_address.<a class="code" href="structaddress.html#aacbeb5a1db9cfa6bcabb47d819818b1e">d_ip_host</a>).<a class="code" href="structjars__cmd.html#a2ac9bbc25760e1a29a170271d68ea390">size</a>());</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="keywordtype">char</span> ip_array_char [ip_size+1]={};</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        strcpy (ip_array_char,(host_address.<a class="code" href="structaddress.html#aacbeb5a1db9cfa6bcabb47d819818b1e">d_ip_host</a>).c_str());</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="comment">//******************* Empieza el envio de comandos </span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="keywordtype">char</span> payload[16]={};<span class="comment">//lo define así ya que usa los subindices para contar</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        printf(<span class="stringliteral">&quot;Connecting to %s...\n&quot;</span>, cfg.<a class="code" href="classsp601__config.html#ad6492c0298daa685d0ba7dfc38a85b14">SP601_IP</a>);<span class="comment">//muestra la IP del SP601</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="comment">//************** Define el socket : crea , direcciona y configura el socket UDP*****************************************************</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <a class="code" href="JarsControl_8h.html#ab2dd9706c8afee0101f9fb673f23a9e1">fpga_con_init</a>(ip_array_char,host_address.<a class="code" href="structaddress.html#aeeeea32d04a247d4a5351e33af8674a8">d_port_block</a>);<span class="comment">//Declar estos valores en el .h y definirlos en el constructor//char * IP</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        printf(<span class="stringliteral">&quot;Se creó el socket UDP con dirección de IP del host igual a : %s\n&quot;</span>,ip_array_char );</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="comment">//************** Envía y establece la dirección IP del SP601 ************************</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="comment">//el valor de solo los números de la dirección de la IP es guardado en payload de tipo char</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <a class="code" href="JarsControl_8h.html#ae3793cb02de7605c651d1762415629f8">IPstr_to_bytearray</a>(cfg.<a class="code" href="classsp601__config.html#ad6492c0298daa685d0ba7dfc38a85b14">SP601_IP</a>, payload);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="comment">//Envia el valor de la IP del SP601 al SP601</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152abff6b2d1371663911c20d04738892bfd">SET_SP601_IP</a>,0,payload,4);<span class="comment">//4 bytes del IP</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <span class="comment">//setea a cero char los valores del payload</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        memset(payload,0,strlen(payload));</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="comment">//************** Envía y establece la dirección IP de la PC ************************</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="comment">//el valor de solo los números de la dirección de la IP es guardado en payload de tipo char</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <a class="code" href="JarsControl_8h.html#ae3793cb02de7605c651d1762415629f8">IPstr_to_bytearray</a>(ip_array_char, payload); <span class="comment">//valor de IP-host en char* dado por el GNURadio block</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="comment">//Envia el valor de la IP de la PC al SP601</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152abd7b2f700ca4ef2b11180557059e6bbd">SET_COMMS_IP</a>,0,payload,4);</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <span class="comment">//setea a cero char los valores del payload</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        memset(payload,0,strlen(payload));</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="comment">//************** Envía y establece la MAC de la PC  ************************************</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="comment">//Los valores hexadecimales de la mascará de la PC son guardados en payload en formato tipo char</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <a class="code" href="JarsControl_8h.html#a9fe1a038e1882c74961f61186cc7a811">MACstr_to_bytearray</a>(mac_array_char, payload); <span class="comment">// valor del MAC -host en char* dado por el GNURadio block</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="comment">//Envia el valor de la MAC de la PC al SP601</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152aedb06bfaf37d18638b99cabc860b5c4b">SET_COMMS_MAC</a>,0,payload,6);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="comment">//setea a cero char los valores del payload</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        memset(payload,0,strlen(payload));</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="comment">//************** Envía y establece el puerto de la PC ************************************</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <span class="comment">//Divide el puerto de la PC y lo guarda en el payload</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <a class="code" href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e">intToBytes</a>(host_address.<a class="code" href="structaddress.html#aeeeea32d04a247d4a5351e33af8674a8">d_port_block</a>, payload, 2);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <span class="comment">//Envía el valor del puerto de la PC al SP601</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a57446329e1b880f1e79096d89ca90abf">SET_COMMS_PORT</a>,0,payload,2);</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <span class="comment">//setea a cero char los valores del payload</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        memset(payload,0,strlen(payload));</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="comment">//************** Envía y establece el puerto del SP601 ************************************</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <span class="comment">//Divide el puerto de la SP601 y lo guarda en el payload</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <a class="code" href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e">intToBytes</a>(cfg.<a class="code" href="classsp601__config.html#af3c1756c00b9954a476698c62911feb7">SP601_PORT</a>,payload,2);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="comment">//Envía el valor del puerto de la SP601 al SP601</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        send(<a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a578a2dc0f32dacf50c510f7009c12d1f">SET_SP601_PORT</a>,0,payload,2);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <span class="comment">//setea a cero char los valores del payload</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        memset(payload,0,strlen(payload));</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <span class="comment">//We can check the current values for MAC, IP and PORT</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;}</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">//****************************** Nos da el número de bytes recibidos</span></div><div class="line"><a name="l01026"></a><span class="lineno"><a class="line" href="classsp601__command.html#a0f20108067e472db69a628ecb02e2c4a"> 1026</a></span>&#160;ssize_t <a class="code" href="classsp601__command.html#a0f20108067e472db69a628ecb02e2c4a">sp601_command::receive</a>(<span class="keywordtype">char</span> *buffer_rcv)</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;{</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        ssize_t size_rcv_buf = <a class="code" href="JarsControl_8h.html#afd1cbc76708d71bb56dfcaf96eb90eba">fpga_con_recv</a>(buffer_rcv,<a class="code" href="JarsControl_8h.html#ae6cae658beb94f4ddfcaa58ee33dd38b">RCV_BUFSIZE</a>);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <span class="comment">//printf(&quot;Recibido\n&quot;);</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">return</span> size_rcv_buf;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;}</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">//********************************************************************************************************************</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">//******************************************* Define la clase fpga_com ***********************************************</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">//fpga_con_init(&amp;fc, cfg.SP601_IP, cfg.COMMS_PORT, cfg.SP601_PORT)</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">//**************************** Define y establece el socket con las caracteísticas respectivas******************************</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">//void fpga_con_init( fpga_con_t *con, const char *daddr, int lport, int dport ) {</span></div><div class="line"><a name="l01037"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#ab2dd9706c8afee0101f9fb673f23a9e1"> 1037</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="JarsControl_8h.html#ab2dd9706c8afee0101f9fb673f23a9e1">fpga_con_init</a>(<span class="keywordtype">char</span>* host,<span class="keywordtype">int</span> lport ) { <span class="comment">//(#HOST y # PORT llamados desde el bloque)</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <span class="comment">//******************** Define un endpoint local , crea y abre un sovlet local , setea el socket local y lo bind al endpoint local</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="comment">//Creamos un endpoint:representing all IP addresses available on the host and the specified port number.</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        boost::asio::ip::udp::endpoint local_endpoint(boost::asio::ip::address_v4::any(),lport);</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="comment">//Crea un puntero a un socket</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <a class="code" href="JarsControl_8h.html#a422d981f24f5424243f875df0a9ade6b">local_socket</a> = <span class="keyword">new</span> boost::asio::ip::udp::socket(<a class="code" href="JarsControl_8h.html#aa6e78a1fa6723425d76b1aae3928fc9b">local_io_service</a>);</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <a class="code" href="JarsControl_8h.html#a422d981f24f5424243f875df0a9ade6b">local_socket</a>-&gt;open(local_endpoint.protocol()); <span class="comment">// abre el socket especificando el protocolo asociado al endpoint-udp protocolo</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="comment">//******************************* Setea el socket *************************************************************</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        boost::asio::socket_base::reuse_address roption(<span class="keyword">true</span>);<span class="comment">//implementa la opción SOL_SOCKET/SO_REUSEADDR para el del socket</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <a class="code" href="JarsControl_8h.html#a422d981f24f5424243f875df0a9ade6b">local_socket</a>-&gt;set_option(roption);<span class="comment">//Establece la opción roption en el socket</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        boost::asio::socket_base::receive_buffer_size option(2097152);<span class="comment">//Máximo valor que obtendrá para guardar por si se quedan = 2097152</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <a class="code" href="JarsControl_8h.html#a422d981f24f5424243f875df0a9ade6b">local_socket</a>-&gt;set_option(option);</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="comment">//*****************************</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <a class="code" href="JarsControl_8h.html#a422d981f24f5424243f875df0a9ade6b">local_socket</a>-&gt;bind(local_endpoint);<span class="comment">//enlaza el socket al endpoint establecido// Le da al socket dirección y puerto en la red</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="comment">//************************************ Define un endpoint de destino  *************************************************************************************</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        boost::asio::ip::address ip_destino = boost::asio::ip::address::from_string(cfg.<a class="code" href="classsp601__config.html#a67d08111f19266ac84a3781d1c204b6e">sp601_ip_string</a>);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        boost::asio::ip::udp::endpoint <a class="code" href="JarsControl_8h.html#acc668b68847453065b3681978e25f217">destino_endpoint</a>(ip_destino, cfg.<a class="code" href="classsp601__config.html#af3c1756c00b9954a476698c62911feb7">SP601_PORT</a>);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;}</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">// ssize_t is the same as size_t, but is a signed type - read ssize_t as “signed size_t”.</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">//ssize_t is able to represent the number -1, which is returned by several system calls and library functions as a way to indicate error.</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">//***************Envía los paquetes de datos de buf a través del socket especificado en fpga_con_t********************************************************************************</span></div><div class="line"><a name="l01061"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#a8ec1b8a8eeca1b70875f6a4c037dc3e1"> 1061</a></span>&#160;ssize_t <a class="code" href="JarsControl_8h.html#a8ec1b8a8eeca1b70875f6a4c037dc3e1">fpga_con_send</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> len ) { <span class="comment">//ssize_t , is read signed size_t , which can give us -1 as an error.</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">/*The sendto function transmits the data in the buffer through the socket socket to the destination</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment"> address specified by the addr and length arguments. The size argument specifies the number of bytes to</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment"> be transmitted. */</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    ssize_t bytes_send = <a class="code" href="JarsControl_8h.html#a422d981f24f5424243f875df0a9ade6b">local_socket</a>-&gt;send_to(boost::asio::buffer(buf, len), <a class="code" href="JarsControl_8h.html#acc668b68847453065b3681978e25f217">destino_endpoint</a>);<span class="comment">//(void*) buf//se puede quitar el boost::asio::buffer pero al ver GNURadio UDP sink y source lo usan sin problemas</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">if</span>( bytes_send &lt; 0 ) {</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;             printf(<span class="stringliteral">&quot;Error en el envío. Revisar fpga_con_send\n&quot;</span>);</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    }</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keywordflow">return</span> bytes_send;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    </div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;}</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">/*blocking receive: this call will block until a packet is received*/</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">//****************** Recibirá data y luego lo bloqueará hasta que haya alguna data por leer*********************</span></div><div class="line"><a name="l01077"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#afd1cbc76708d71bb56dfcaf96eb90eba"> 1077</a></span>&#160;ssize_t <a class="code" href="JarsControl_8h.html#afd1cbc76708d71bb56dfcaf96eb90eba">fpga_con_recv</a>(<span class="keywordtype">char</span> *dbuf, <span class="keywordtype">size_t</span> dsize ) {</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        ssize_t bytes_receive = <a class="code" href="JarsControl_8h.html#a422d981f24f5424243f875df0a9ade6b">local_socket</a>-&gt;receive(boost::asio::buffer(dbuf, dsize));<span class="comment">//no se especificó en endpoint de envío</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="keywordflow">if</span>( bytes_receive &lt; 0 ) {</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                 printf(<span class="stringliteral">&quot;Error en la recepción. Revisar fpga_con_recv\n&quot;</span>);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        }</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        <span class="keywordflow">return</span> bytes_receive;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;}</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">//void send(uint8_t cmd, char code, const char *payload,char size_payload)</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">//void send(uint8_t cmd, char code, const char *payload,size_t size_payload)</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">//void sp601_command::send(uint8_t cmd, char code, const char *payload, char size_payload)</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">//**********************Dependiendo del cmd y el payload genera el buffer que guardará el comando de envio: cmd_array**************************</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">//**********************Genera el buffer que guardará el paquete de data recibido: buffer_rcv**************************</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">//**********************Verifica los buffers creados imprimiéndolos (printf)******************************************</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">//********************** Envía el comando respectivo (PC-&gt;SP601) y recibe el comando de respuesta (SP601-&gt;PC) /Revisar Excel*******************</span></div><div class="line"><a name="l01095"></a><span class="lineno"><a class="line" href="classsp601__command.html#a190c6be31617bd6b50fc7f4a451a56ac"> 1095</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classsp601__command.html#a190c6be31617bd6b50fc7f4a451a56ac">sp601_command::send</a>(uint8_t cmd, <span class="keywordtype">char</span> code, <span class="keyword">const</span> <span class="keywordtype">char</span> *payload, <span class="keywordtype">size_t</span> size_payload)</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;{</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="keywordtype">char</span> cmd_array[16];</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="keywordtype">char</span> buffer_rcv[<a class="code" href="JarsControl_8h.html#ae6cae658beb94f4ddfcaa58ee33dd38b">RCV_BUFSIZE</a>];<span class="comment">//buffer donde se guardará el mensaje que recibe</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="keywordtype">char</span> size_rcv_buf=0;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="keywordtype">bool</span> ack_received;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <span class="comment">//char size_payload;</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <span class="keywordtype">size_t</span> size_cmd_array;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        uint8_t *info_str;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="comment">//define VERBOSE_MODE para el objeto cfg</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        cfg.<a class="code" href="classsp601__config.html#a6d8f61af0597bc1c6ca208898fc76f77">VERBOSE_MODE</a> = <span class="keyword">true</span>;<span class="comment">//********</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="comment">//printf(&quot;%i\n&quot;,payload[0]);printf(&quot;%i\n&quot;,payload[1]);printf(&quot;%i\n&quot;,payload[2]);</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <span class="comment">//size_payload = strlen(payload);</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        <span class="comment">//size_payload = payload.__size;</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <span class="comment">//printf(&quot;%i&quot;,size_payload);</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        size_cmd_array = 3+size_payload;<span class="comment">//tamaño total después de agregar cmd_array[0],[1],[2]</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        <span class="comment">//printf(&quot;%i&quot;,size_cmd_array);</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="comment">//**************************** Crea el buffer de comando cmd_array ************************************</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        cmd_array[0] = JARS_CMD[cmd].<a class="code" href="structjars__cmd.html#a08d03301fdc843da88b71ab8d5576a97">val</a>;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        cmd_array[1] = code;<span class="comment">//siempre será cero aparentemente</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        cmd_array[2] = JARS_CMD[cmd].<a class="code" href="structjars__cmd.html#a2ac9bbc25760e1a29a170271d68ea390">size</a>;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <span class="comment">//guarda el valor de payload ,del tamaño de size_payload,a partir de cmd_array[3]</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        memcpy(cmd_array+3,payload,size_payload);<span class="comment">//Completa: val,code,size,direccion</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <span class="comment">//**************envia los paquetes de datos del arreglo cmd_array a través del socket</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <a class="code" href="JarsControl_8h.html#a8ec1b8a8eeca1b70875f6a4c037dc3e1">fpga_con_send</a>(cmd_array,size_cmd_array);<span class="comment">//</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        ack_received = <span class="keyword">false</span>;<span class="comment">//*******</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        <span class="comment">//crea el buffer de adquisición si el ack es true</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">if</span>(JARS_CMD[cmd].<a class="code" href="structjars__cmd.html#a667569fb6dd6e6bc0b0699d0e1a49b22">ack</a>)</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        {</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                size_rcv_buf = <a class="code" href="JarsControl_8h.html#afd1cbc76708d71bb56dfcaf96eb90eba">fpga_con_recv</a>(buffer_rcv,<a class="code" href="JarsControl_8h.html#ae6cae658beb94f4ddfcaa58ee33dd38b">RCV_BUFSIZE</a>);<span class="comment">//pone el valor en bytes del buffer receptor 1472</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                ack_received = <span class="keyword">true</span>;<span class="comment">//******</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        }</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="comment">//************************* Da valor al arreglo info_str dependiendo del tipo de configuración ****************************************************</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <span class="comment">//******PAsa de char [] a uint8_t</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152abff6b2d1371663911c20d04738892bfd">SET_SP601_IP</a>:      <span class="comment">//Guarda el valor de la IP del SP601 en formato literal string en info_str para mostrar en pantalla</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                                        <a class="code" href="JarsControl_8h.html#a0a6858dd58a8b8b154e5dd149fafd01d">bytearray_to_IPstr</a>(payload,cfg.<a class="code" href="classsp601__config.html#ad6492c0298daa685d0ba7dfc38a85b14">SP601_IP</a>);<span class="comment">//pasa los números de char a int de la IP  y los guarda en formato ...</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                                        info_str = (uint8_t *)malloc(strlen(cfg.<a class="code" href="classsp601__config.html#ad6492c0298daa685d0ba7dfc38a85b14">SP601_IP</a>)+1);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                                        memcpy(info_str,cfg.<a class="code" href="classsp601__config.html#ad6492c0298daa685d0ba7dfc38a85b14">SP601_IP</a>,strlen(cfg.<a class="code" href="classsp601__config.html#ad6492c0298daa685d0ba7dfc38a85b14">SP601_IP</a>)+1);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a578a2dc0f32dacf50c510f7009c12d1f">SET_SP601_PORT</a>:    <span class="comment">//Guarda el valor del puerto en info_str (char)</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                                        <a class="code" href="JarsControl_8h.html#a19a52ae0d3c91c019542bc76a720aef9">bytearray_to_int</a>(payload,cfg.<a class="code" href="classsp601__config.html#af3c1756c00b9954a476698c62911feb7">SP601_PORT</a>);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                                        info_str = (uint8_t *)malloc(10);</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                                        <a class="code" href="JarsControl_8h.html#a44ec176a02a62ada468ebde1b3f6e9f0">itoa</a>(cfg.<a class="code" href="classsp601__config.html#af3c1756c00b9954a476698c62911feb7">SP601_PORT</a>,(<span class="keywordtype">char</span> *)info_str,10);</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152abd7b2f700ca4ef2b11180557059e6bbd">SET_COMMS_IP</a>:      <span class="comment">//Guarda el valor de la IP de la PC en formato literal string en info_str para mostrar en pantalla</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                                        <a class="code" href="JarsControl_8h.html#a0a6858dd58a8b8b154e5dd149fafd01d">bytearray_to_IPstr</a>(payload,cfg.<a class="code" href="classsp601__config.html#a5f4214fdc2d5b4cc6cf2665ad6233838">IP_host</a>);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                                        info_str = (uint8_t *)malloc(strlen(cfg.<a class="code" href="classsp601__config.html#a5f4214fdc2d5b4cc6cf2665ad6233838">IP_host</a>)+1);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                                        memcpy(info_str,cfg.<a class="code" href="classsp601__config.html#a5f4214fdc2d5b4cc6cf2665ad6233838">IP_host</a>,strlen(cfg.<a class="code" href="classsp601__config.html#a5f4214fdc2d5b4cc6cf2665ad6233838">IP_host</a>)+1);</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a57446329e1b880f1e79096d89ca90abf">SET_COMMS_PORT</a>:    <span class="comment">//Guarda el valor del puerto en info_str (char)</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                        <a class="code" href="JarsControl_8h.html#a19a52ae0d3c91c019542bc76a720aef9">bytearray_to_int</a>(payload,cfg.<a class="code" href="classsp601__config.html#aa8d75acd776756f7b46560c340a4817d">PORT_host</a>);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                                        <span class="comment">//printf(&quot;%i\n&quot;, cfg.COMMS_PORT);</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                                        info_str = (uint8_t *)malloc(10);</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                                        <span class="comment">//guarda el valor del puerto en info_str (char)</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                                        <span class="comment">//Lo cambia de int a char para mostrarlo como string</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                                        <a class="code" href="JarsControl_8h.html#a44ec176a02a62ada468ebde1b3f6e9f0">itoa</a>(cfg.<a class="code" href="classsp601__config.html#aa8d75acd776756f7b46560c340a4817d">PORT_host</a>,(<span class="keywordtype">char</span> *)info_str,10);</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152aedb06bfaf37d18638b99cabc860b5c4b">SET_COMMS_MAC</a>:     <span class="comment">//****Guarda el valor de la MAC de la PC en formato literal string en info_str para mostrar en pantalla</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                                        <a class="code" href="JarsControl_8h.html#a186f7c0fc2f44b39853cd79d8daa6b65">bytearray_to_MACstr</a>(payload,cfg.<a class="code" href="classsp601__config.html#a2c2cf407fda2eff4bfb66c2624105c7f">MAC_host</a>);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                                        info_str = (uint8_t *)malloc(strlen(cfg.<a class="code" href="classsp601__config.html#a2c2cf407fda2eff4bfb66c2624105c7f">MAC_host</a>)+1);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                                        memcpy(info_str,cfg.<a class="code" href="classsp601__config.html#a2c2cf407fda2eff4bfb66c2624105c7f">MAC_host</a>,strlen(cfg.<a class="code" href="classsp601__config.html#a2c2cf407fda2eff4bfb66c2624105c7f">MAC_host</a>)+1);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a685f467976dffd4af61e2c198bba3e07">SEND_COMMAND</a>:</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                                        <span class="comment">//******************* Creará un arreglo(info_str) donde se guardará el estado del                                               JARS:RST_CTRL,RST_CTRL,SELECT_RXD,POWER_RXD,PROG_RXD,ENABLE_TRANSF,DISABLE_TRANSF************</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                                        <span class="comment">//********** Recibirá el primer paquete de datos mediante recv()*****************************</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                                        <span class="comment">//-----------Verifica mediante el payload[1] que se haya enviado el modo correcto de configuración------------------</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                                        info_str = (uint8_t *)malloc(10);</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                                        memset(info_str,0,10);<span class="comment">//define el espacio de memoria info_str con 10 ceros.</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                        <span class="comment">//Crea un indicador que define el arreglo de estados info_str</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                                        <span class="keywordtype">char</span> cmd_acq;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                                        cmd_acq = (payload[1]&gt;&gt;4)&amp;15;<span class="comment">//parece que el payload guarda el comando de estado</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                                        <span class="keywordflow">if</span>(cmd_acq==<a class="code" href="JarsControl_8h.html#a1aa9678f48f9b9661062c9246e64993a">RST_CTRL</a>) sprintf((<span class="keywordtype">char</span> *)(info_str), <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;RST_CTRL&quot;</span>);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                                        <span class="comment">//else if(cmd_acq==MODE_OPER) sprintf((char *)(info_str), &quot;%s&quot;, &quot;RST_CTRL&quot;);</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(cmd_acq==<a class="code" href="JarsControl_8h.html#a52e278dd9e601652e8ab11b70c53ef6e">MODE_OPER</a>) sprintf((<span class="keywordtype">char</span> *)(info_str), <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;MODE_OPER&quot;</span>);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(cmd_acq==<a class="code" href="JarsControl_8h.html#ab8923675701bbbb7f51c4e68fac5e588">ELECTION_RXD</a>) sprintf((<span class="keywordtype">char</span> *)(info_str), <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;SELECT_RXD&quot;</span>);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(cmd_acq==<a class="code" href="JarsControl_8h.html#a063240a0c681e13158e249f55ac4b750">POWER_RXD</a>) sprintf((<span class="keywordtype">char</span> *)(info_str), <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;POWER_RXD&quot;</span>);</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(cmd_acq==<a class="code" href="JarsControl_8h.html#aefde68a634d66b7039aa56de3fd5301b">PROG_RXD</a>) sprintf((<span class="keywordtype">char</span> *)(info_str), <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;PROG_RXD&quot;</span>);</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(cmd_acq==<a class="code" href="JarsControl_8h.html#ad7e5e3b2ac85d92fe9b81bac2368ca02">ENABLE_TRANSF</a>) sprintf((<span class="keywordtype">char</span> *)(info_str), <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;ENABLE_TRANSF&quot;</span>);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(cmd_acq==<a class="code" href="JarsControl_8h.html#aacac2365f297d20c92dac6c32a87c6a3">DISABLE_TRANSF</a>) sprintf((<span class="keywordtype">char</span> *)(info_str), <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;DISABLE_TRANSF&quot;</span>);</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                                        <span class="comment">// Get the value returned from the UDP receiver thread</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                                        <span class="comment">// First packet</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                                        size_rcv_buf = <a class="code" href="JarsControl_8h.html#afd1cbc76708d71bb56dfcaf96eb90eba">fpga_con_recv</a>(buffer_rcv,<a class="code" href="JarsControl_8h.html#ae6cae658beb94f4ddfcaa58ee33dd38b">RCV_BUFSIZE</a>);<span class="comment">//Recibe el paquete en el buffer de 1472 bytes de tamaño</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                                        <span class="comment">// Revisar los respectivos bits de buffer_rcv para colocar el info_str el comando que fue enviado</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a55636b09cf88b31facd828042757e8cd">DATA_LOOPS</a>:</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                                        info_str = (uint8_t *)malloc(10);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                                        cfg.<a class="code" href="classsp601__config.html#a6d8f61af0597bc1c6ca208898fc76f77">VERBOSE_MODE</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152af2fb94d1fd1739ad68220e57882efa23">GET_VALUE</a>:</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                                        info_str = (uint8_t *)malloc(10);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a28b6b130f7a5b8cdbee96bb17ef151af">SEND_FILTER</a>:</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                                        <span class="comment">//Recibe el paquete de respuesta de envio del sp601</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                                        info_str = (uint8_t *)malloc(12);</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                                        memset(info_str,0,12);<span class="comment">//establece el arreglo info_str con 12 ceros, pero tipo char</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                                        sprintf((<span class="keywordtype">char</span> *)(info_str), <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;WRITE_FILTER&quot;</span>);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                                        <span class="comment">//Get the value returned from the UDP receiver thread</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                                        <span class="comment">//First packet.</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                                        size_rcv_buf = <a class="code" href="JarsControl_8h.html#afd1cbc76708d71bb56dfcaf96eb90eba">fpga_con_recv</a>(buffer_rcv,<a class="code" href="JarsControl_8h.html#ae6cae658beb94f4ddfcaa58ee33dd38b">RCV_BUFSIZE</a>);</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                        printf(<span class="stringliteral">&quot;Filter received\n&quot;</span>);</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a7316843e88740cd819c6427a7f833df6">NOOP</a>:              <span class="comment">//No muestra nada</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                                        info_str = (uint8_t *)malloc(10);</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                                        cfg.<a class="code" href="classsp601__config.html#a6d8f61af0597bc1c6ca208898fc76f77">VERBOSE_MODE</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                <span class="keywordflow">default</span>:</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                                        printf(<span class="stringliteral">&quot;Error: Command Not Found[%s]\n&quot;</span>, JARS_CMD[cmd].<a class="code" href="structjars__cmd.html#ac1538c1c69d889eefbabfc077e59d96f">name</a>);</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        }</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="comment">//**************** Imprime el nombre del comando enviado y el estado del JARS y se lee el paquete recibido en formato hexadecimal</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="keywordflow">if</span>((cfg.<a class="code" href="classsp601__config.html#a6d8f61af0597bc1c6ca208898fc76f77">VERBOSE_MODE</a> == <span class="keyword">true</span>) &amp;&amp; (cmd != <a class="code" href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152af2fb94d1fd1739ad68220e57882efa23">GET_VALUE</a>))</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        {</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        <span class="comment">/*      printf(&quot;%s : %s\n&quot;, JARS_CMD[cmd].name,(uint8_t *)info_str);//muestra el name y el info_str en uint8_t(uint8_t* para asegurar)</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment">                printf(&quot;Received: &quot;);</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">                for(uint16_t i = 0 ; i&lt;size_rcv_buf ; i++)//numero de bytes leidos en el buffer</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">                {</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">                        printf(&quot;%02X,&quot;,(uint8_t)buffer_rcv[i]);//Se lee el char que llega en formato hexadecimal</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">                }</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">                printf(&quot;\n&quot;);*/</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                <span class="comment">//size_t size_info_str = sizeof(info_str);</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                <span class="comment">//memset(info_str,0,size_info_str);</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;          printf(<span class="stringliteral">&quot;el valor que llegó fue: %s&quot;</span>,buffer_rcv );</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        }</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        <span class="comment">//**************** Muestra todos los elementos del buffer: cmd_array en hexadecimal *********************</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="comment">/*if(JARS_CMD[cmd].ack &amp;&amp; ack_received)</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">        {       if(cfg.VERBOSE_MODE)</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">                {</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">                        printf(&quot;[OK] Validation for command [%s][%i][&quot;,JARS_CMD[cmd].name,code);//code sera siempre cero</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment">                        for(uint16_t i = 0 ; i&lt;(size_cmd_array-1) ; i++)</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">                        {</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment">                                printf(&quot;%02X,&quot;,(uint8_t)cmd_array[i]);</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">                        }</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">                        printf(&quot;%02X]&quot;,(uint8_t)cmd_array[size_cmd_array-1]);</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">                        printf(&quot;\n&quot;);</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">                }</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">        }*/</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;}</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="comment">//******************** Métodos usados por swich en send **************************************************</span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment">//*************** Guarda cada numero de la IP dentro del arreglo parts en formato char *******************</span></div><div class="line"><a name="l01242"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#ae3793cb02de7605c651d1762415629f8"> 1242</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="JarsControl_8h.html#ae3793cb02de7605c651d1762415629f8">IPstr_to_bytearray</a>(<span class="keywordtype">char</span> *IPstr, <span class="keywordtype">char</span> *parts){</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <span class="keywordtype">char</span> * pch;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  uint8_t ii=0;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  pch = strtok (IPstr,<span class="stringliteral">&quot;.&quot;</span>);<span class="comment">//divide el IPstr , dilimitado por .</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="keywordflow">while</span> (pch != NULL)</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  {</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    parts[ii] = (char)atoi(pch);<span class="comment">//convierte string a int y luego lo guarda como char</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    pch = strtok (NULL, <span class="stringliteral">&quot;.&quot;</span>);</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    ii=ii+1;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  }</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;}</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">//************************** Nos da la IP en forma binaria y string ****************************************</span></div><div class="line"><a name="l01255"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#a0a6858dd58a8b8b154e5dd149fafd01d"> 1255</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="JarsControl_8h.html#a0a6858dd58a8b8b154e5dd149fafd01d">bytearray_to_IPstr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *bytes, <span class="keywordtype">char</span> *IPstr){</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  sprintf(IPstr,<span class="stringliteral">&quot;%i.%i.%i.%i&quot;</span>,(uint8_t)bytes[0],(uint8_t)bytes[1],(uint8_t)bytes[2],(uint8_t)bytes[3]);</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <span class="comment">//printf(&quot;%s\n&quot;, IPstr);</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;}</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">//************************** Convierte de bytes a enteros **************************************************</span></div><div class="line"><a name="l01261"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#a19a52ae0d3c91c019542bc76a720aef9"> 1261</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="JarsControl_8h.html#a19a52ae0d3c91c019542bc76a720aef9">bytearray_to_int</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *byte_array, <span class="keywordtype">int</span> num){</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; 2; i++) {</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    num += (uint16_t)((uint8_t)byte_array[i] &lt;&lt; (i*8));</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  }</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;}</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">//*************** Guarda cada numero hexadecimal de la máscara dentro del arreglo parts en formato char *******************</span></div><div class="line"><a name="l01268"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#a9fe1a038e1882c74961f61186cc7a811"> 1268</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="JarsControl_8h.html#a9fe1a038e1882c74961f61186cc7a811">MACstr_to_bytearray</a>(<span class="keywordtype">char</span> *MACstr, <span class="keywordtype">char</span> *parts){</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="keywordtype">char</span> *pch;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  uint8_t ii=0;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  pch = strtok (MACstr,<span class="stringliteral">&quot;:&quot;</span>);</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="keywordflow">while</span> (pch != NULL)</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  {<span class="comment">//long int strtol(const char *str, char **endptr, int base)</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    parts[ii] = (char)strtol(pch,NULL,16);<span class="comment">//cambia de string a long int, tomando el valor hexadecimal 16, y lo guarda como tipo char</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="comment">//printf(&quot;p[%i]: %i\n&quot;, ii,(uint8_t)parts[ii]);</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    pch = strtok (NULL, <span class="stringliteral">&quot;:&quot;</span>);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    ii=ii+1;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  }</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;}</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">//*************** Divide el numero por bytes y lo guarda en arrayOfByte *****************************************************</span></div><div class="line"><a name="l01282"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e"> 1282</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e">intToBytes</a>(<span class="keywordtype">int</span> number, <span class="keywordtype">char</span> *arrayOfByte, <span class="keywordtype">size_t</span> <a class="code" href="structjars__cmd.html#a2ac9bbc25760e1a29a170271d68ea390">size</a>){</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = size; i &gt; 0; i--) {</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    arrayOfByte[size-i] = (char)(number &gt;&gt; ((i-1)*8));</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  }</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;}</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">//*************** Guarda los valores del hexadecimal en un arreglo string literal ********************************************</span></div><div class="line"><a name="l01289"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#a186f7c0fc2f44b39853cd79d8daa6b65"> 1289</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="JarsControl_8h.html#a186f7c0fc2f44b39853cd79d8daa6b65">bytearray_to_MACstr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *bytes, <span class="keywordtype">char</span> *MACstr){</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  sprintf(MACstr,<span class="stringliteral">&quot;%02X:%02X:%02X:%02X:%02X:%02X&quot;</span>,(uint8_t)bytes[0],(uint8_t)bytes[1],(uint8_t)bytes[2],(uint8_t)bytes[3],(uint8_t)bytes[4],(uint8_t)bytes[5]);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;}</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment">// Implementation of itoa()</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">//itoa(cfg.COMMS_PORT,(char *)info_str,10);</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">//************** Guarda dentro de str los valores del num en caracteres char[] ***************</span></div><div class="line"><a name="l01296"></a><span class="lineno"><a class="line" href="JarsControl_8h.html#a44ec176a02a62ada468ebde1b3f6e9f0"> 1296</a></span>&#160;<span class="keywordtype">char</span>* <a class="code" href="JarsControl_8h.html#a44ec176a02a62ada468ebde1b3f6e9f0">itoa</a>(<span class="keywordtype">int</span> num, <span class="keywordtype">char</span>* str, <span class="keywordtype">int</span> base){</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordtype">bool</span> isNegative = <span class="keyword">false</span>;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="comment">/* Handle 0 explicitely, otherwise empty string is printed for 0 */</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">if</span> (num == 0)</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    {</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        str[i++] = <span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        str[i] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <span class="keywordflow">return</span> str;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    }</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="comment">// In standard itoa(), negative numbers are handled only with</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="comment">// base 10. Otherwise numbers are considered unsigned.</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordflow">if</span> (num &lt; 0 &amp;&amp; base == 10)</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    {</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        isNegative = <span class="keyword">true</span>;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        num = -num;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    }</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="comment">// Process individual digits</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="comment">//guarda cada digito de num en str (el último dígito en el primer elemnto del str)/al reves</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keywordflow">while</span> (num != 0)</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    {</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        <span class="keywordtype">int</span> rem = num % base;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        str[i++] = (rem &gt; 9)? (rem-10) + <span class="charliteral">&#39;a&#39;</span> : rem + <span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        num = num/base;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    }</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="comment">// If number is negative, append &#39;-&#39;</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keywordflow">if</span> (isNegative)</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        str[i++] = <span class="charliteral">&#39;-&#39;</span>;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    str[i] = <span class="charliteral">&#39;\0&#39;</span>; <span class="comment">// Append string terminator</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="comment">// Reverse the string</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="keywordtype">int</span> n = strlen(str);</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="comment">// Swap character starting from two</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="comment">// corners</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n/2; i++)</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;       swap(str[i], str[n-i-1]);</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordflow">return</span> str;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;}</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="struct__SystemParam_html_ab86ec2eb0141deaa322b4d78c975dd25"><div class="ttname"><a href="struct__SystemParam.html#ab86ec2eb0141deaa322b4d78c975dd25">_SystemParam::m_nProfiles</a></div><div class="ttdeci">unsigned int m_nProfiles</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:127</div></div>
<div class="ttc" id="classsp601__config_html_a67d08111f19266ac84a3781d1c204b6e"><div class="ttname"><a href="classsp601__config.html#a67d08111f19266ac84a3781d1c204b6e">sp601_config::sp601_ip_string</a></div><div class="ttdeci">string sp601_ip_string</div><div class="ttdef"><b>Definition:</b> JarsControl.h:186</div></div>
<div class="ttc" id="ExperimentConstants_8h_html_a764ae24ad191463aa0dc64ea1e105d13"><div class="ttname"><a href="ExperimentConstants_8h.html#a764ae24ad191463aa0dc64ea1e105d13">BY_CMD</a></div><div class="ttdeci">#define BY_CMD</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:108</div></div>
<div class="ttc" id="JarsControl_8h_html_ad7e5e3b2ac85d92fe9b81bac2368ca02"><div class="ttname"><a href="JarsControl_8h.html#ad7e5e3b2ac85d92fe9b81bac2368ca02">ENABLE_TRANSF</a></div><div class="ttdeci">#define ENABLE_TRANSF</div><div class="ttdef"><b>Definition:</b> JarsControl.h:77</div></div>
<div class="ttc" id="struct__GlobRCParam_html_a3266169525e2a7d77be441ba398a105a"><div class="ttname"><a href="struct__GlobRCParam.html#a3266169525e2a7d77be441ba398a105a">_GlobRCParam::FixRCP</a></div><div class="ttdeci">RadarControllerParam FixRCP</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:192</div></div>
<div class="ttc" id="structjars__cmd_html_a2ac9bbc25760e1a29a170271d68ea390"><div class="ttname"><a href="structjars__cmd.html#a2ac9bbc25760e1a29a170271d68ea390">jars_cmd::size</a></div><div class="ttdeci">char size</div><div class="ttdef"><b>Definition:</b> JarsControl.h:84</div></div>
<div class="ttc" id="classsp601__config_html"><div class="ttname"><a href="classsp601__config.html">sp601_config</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:179</div></div>
<div class="ttc" id="JicaHeader_8h_html_acfa1e2b991d398ea406cdd6198bb2ee6"><div class="ttname"><a href="JicaHeader_8h.html#acfa1e2b991d398ea406cdd6198bb2ee6">context</a></div><div class="ttdeci">zmq::context_t context(1)</div></div>
<div class="ttc" id="JarsControl_8h_html_a8ec1b8a8eeca1b70875f6a4c037dc3e1"><div class="ttname"><a href="JarsControl_8h.html#a8ec1b8a8eeca1b70875f6a4c037dc3e1">fpga_con_send</a></div><div class="ttdeci">ssize_t fpga_con_send(const char *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:1061</div></div>
<div class="ttc" id="classExpParameters_html_a749ba5fb272f835591296dae9bcccd53"><div class="ttname"><a href="classExpParameters.html#a749ba5fb272f835591296dae9bcccd53">ExpParameters::OwnWindow</a></div><div class="ttdeci">bool OwnWindow</div><div class="ttdef"><b>Definition:</b> ExperimentParameters.h:34</div></div>
<div class="ttc" id="JarsControl_8h_html_a5a3ca937b4f7181095b415041ac2a152a7316843e88740cd819c6427a7f833df6"><div class="ttname"><a href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a7316843e88740cd819c6427a7f833df6">NOOP</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:62</div></div>
<div class="ttc" id="struct__GlobPParam_html_ac28bdb8b27ff1dc65f63569f004497f2"><div class="ttname"><a href="struct__GlobPParam.html#ac28bdb8b27ff1dc65f63569f004497f2">_GlobPParam::Dyn_nCardSequence</a></div><div class="ttdeci">unsigned char * Dyn_nCardSequence</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:174</div></div>
<div class="ttc" id="classsp601__config_html_a232a589f07ec9b53c41f53954fc2acac"><div class="ttname"><a href="classsp601__config.html#a232a589f07ec9b53c41f53954fc2acac">sp601_config::UDP_timeout</a></div><div class="ttdeci">char UDP_timeout</div><div class="ttdef"><b>Definition:</b> JarsControl.h:192</div></div>
<div class="ttc" id="classMemoryManager_html_a06e03642b89e7f6aa2745efa87e8af7f"><div class="ttname"><a href="classMemoryManager.html#a06e03642b89e7f6aa2745efa87e8af7f">MemoryManager::m_nNIDoubleBuffer</a></div><div class="ttdeci">complex&lt; short &gt; * m_nNIDoubleBuffer</div><div class="ttdef"><b>Definition:</b> MemoryManager.h:23</div></div>
<div class="ttc" id="JarsControl_8h_html_a5a3ca937b4f7181095b415041ac2a152a55636b09cf88b31facd828042757e8cd"><div class="ttname"><a href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a55636b09cf88b31facd828042757e8cd">DATA_LOOPS</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:62</div></div>
<div class="ttc" id="JarsControl_8h_html_a1aa9678f48f9b9661062c9246e64993a"><div class="ttname"><a href="JarsControl_8h.html#a1aa9678f48f9b9661062c9246e64993a">RST_CTRL</a></div><div class="ttdeci">#define RST_CTRL</div><div class="ttdef"><b>Definition:</b> JarsControl.h:72</div></div>
<div class="ttc" id="class__JARSControl_html_a6e97ca0b4324bc1af443e36b28bb1d3e"><div class="ttname"><a href="class__JARSControl.html#a6e97ca0b4324bc1af443e36b28bb1d3e">_JARSControl::InternalRcv</a></div><div class="ttdeci">void InternalRcv()</div><div class="ttdef"><b>Definition:</b> JarsControl.h:757</div></div>
<div class="ttc" id="classsp601__config_html_a0f455ea81940b646c26beefe54ce475a"><div class="ttname"><a href="classsp601__config.html#a0f455ea81940b646c26beefe54ce475a">sp601_config::sp601_config</a></div><div class="ttdeci">sp601_config()</div><div class="ttdef"><b>Definition:</b> JarsControl.h:214</div></div>
<div class="ttc" id="classsp601__config_html_a2c2cf407fda2eff4bfb66c2624105c7f"><div class="ttname"><a href="classsp601__config.html#a2c2cf407fda2eff4bfb66c2624105c7f">sp601_config::MAC_host</a></div><div class="ttdeci">char * MAC_host</div><div class="ttdef"><b>Definition:</b> JarsControl.h:188</div></div>
<div class="ttc" id="classMemoryManager_html_acdf947edccf307a07382da6ee435d214"><div class="ttname"><a href="classMemoryManager.html#acdf947edccf307a07382da6ee435d214">MemoryManager::m_iSizeNIBuffer</a></div><div class="ttdeci">int m_iSizeNIBuffer</div><div class="ttdef"><b>Definition:</b> MemoryManager.h:21</div></div>
<div class="ttc" id="JarsControl_8h_html_afd1cbc76708d71bb56dfcaf96eb90eba"><div class="ttname"><a href="JarsControl_8h.html#afd1cbc76708d71bb56dfcaf96eb90eba">fpga_con_recv</a></div><div class="ttdeci">ssize_t fpga_con_recv(char *dbuf, size_t dsize)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:1077</div></div>
<div class="ttc" id="JarsControl_8h_html_aa6e78a1fa6723425d76b1aae3928fc9b"><div class="ttname"><a href="JarsControl_8h.html#aa6e78a1fa6723425d76b1aae3928fc9b">local_io_service</a></div><div class="ttdeci">boost::asio::io_service local_io_service</div><div class="ttdef"><b>Definition:</b> JarsControl.h:42</div></div>
<div class="ttc" id="classExpParameters_html_ad295cabf051467354884f7dc952aced6"><div class="ttname"><a href="classExpParameters.html#ad295cabf051467354884f7dc952aced6">ExpParameters::MySystemParam</a></div><div class="ttdeci">SystemParam MySystemParam</div><div class="ttdef"><b>Definition:</b> ExperimentParameters.h:24</div></div>
<div class="ttc" id="struct__GlobPParam_html_a4e4bde5e3d036d9e786677cb2000d74a"><div class="ttname"><a href="struct__GlobPParam.html#a4e4bde5e3d036d9e786677cb2000d74a">_GlobPParam::m_nCards</a></div><div class="ttdeci">unsigned int m_nCards</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:181</div></div>
<div class="ttc" id="JarsControl_8h_html_a422d981f24f5424243f875df0a9ade6b"><div class="ttname"><a href="JarsControl_8h.html#a422d981f24f5424243f875df0a9ade6b">local_socket</a></div><div class="ttdeci">boost::asio::ip::udp::socket * local_socket</div><div class="ttdef"><b>Definition:</b> JarsControl.h:41</div></div>
<div class="ttc" id="classMemoryManager_html_af53d94ce1836a26f87969064c38900a2"><div class="ttname"><a href="classMemoryManager.html#af53d94ce1836a26f87969064c38900a2">MemoryManager::m_nNIBuffer</a></div><div class="ttdeci">complex&lt; short &gt; * m_nNIBuffer</div><div class="ttdef"><b>Definition:</b> MemoryManager.h:22</div></div>
<div class="ttc" id="classsp601__config_html_af3c1756c00b9954a476698c62911feb7"><div class="ttname"><a href="classsp601__config.html#af3c1756c00b9954a476698c62911feb7">sp601_config::SP601_PORT</a></div><div class="ttdeci">int SP601_PORT</div><div class="ttdef"><b>Definition:</b> JarsControl.h:185</div></div>
<div class="ttc" id="struct__SystemParam_html_aa49917e56c5325e41bbb7430e092cf46"><div class="ttname"><a href="struct__SystemParam.html#aa49917e56c5325e41bbb7430e092cf46">_SystemParam::m_sFilterPath</a></div><div class="ttdeci">char m_sFilterPath[_MAX_PATH]</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:133</div></div>
<div class="ttc" id="classsp601__command_html"><div class="ttname"><a href="classsp601__command.html">sp601_command</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:89</div></div>
<div class="ttc" id="JarsControl_8h_html_a5a3ca937b4f7181095b415041ac2a152a9dd105b07676790bd963c49f607588b9"><div class="ttname"><a href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a9dd105b07676790bd963c49f607588b9">GET_SP601_MAC</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:62</div></div>
<div class="ttc" id="RdpToolsBeta_8h_html"><div class="ttname"><a href="RdpToolsBeta_8h.html">RdpToolsBeta.h</a></div></div>
<div class="ttc" id="struct__SystemParam_html_a19a6cf532b877478838544bb8471c53b"><div class="ttname"><a href="struct__SystemParam.html#a19a6cf532b877478838544bb8471c53b">_SystemParam::m_nSamples</a></div><div class="ttdeci">unsigned int m_nSamples</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:126</div></div>
<div class="ttc" id="JarsControl_8h_html_a5a3ca937b4f7181095b415041ac2a152aedb06bfaf37d18638b99cabc860b5c4b"><div class="ttname"><a href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152aedb06bfaf37d18638b99cabc860b5c4b">SET_COMMS_MAC</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:62</div></div>
<div class="ttc" id="structaddress_html"><div class="ttname"><a href="structaddress.html">address</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:64</div></div>
<div class="ttc" id="classExpParameters_html_a6f9185d4fae1038b1bf6672cd5937eef"><div class="ttname"><a href="classExpParameters.html#a6f9185d4fae1038b1bf6672cd5937eef">ExpParameters::MyGPParam</a></div><div class="ttdeci">GlobPParam MyGPParam</div><div class="ttdef"><b>Definition:</b> ExperimentParameters.h:25</div></div>
<div class="ttc" id="structaddress_html_aeeeea32d04a247d4a5351e33af8674a8"><div class="ttname"><a href="structaddress.html#aeeeea32d04a247d4a5351e33af8674a8">address::d_port_block</a></div><div class="ttdeci">int d_port_block</div><div class="ttdef"><b>Definition:</b> JarsControl.h:67</div></div>
<div class="ttc" id="JarsControl_8h_html_a44ec176a02a62ada468ebde1b3f6e9f0"><div class="ttname"><a href="JarsControl_8h.html#a44ec176a02a62ada468ebde1b3f6e9f0">itoa</a></div><div class="ttdeci">char * itoa(int num, char *str, int base)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:1296</div></div>
<div class="ttc" id="JarsControl_8h_html_a5a3ca937b4f7181095b415041ac2a152a685f467976dffd4af61e2c198bba3e07"><div class="ttname"><a href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a685f467976dffd4af61e2c198bba3e07">SEND_COMMAND</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:62</div></div>
<div class="ttc" id="JarsControl_8h_html_ab2dd9706c8afee0101f9fb673f23a9e1"><div class="ttname"><a href="JarsControl_8h.html#ab2dd9706c8afee0101f9fb673f23a9e1">fpga_con_init</a></div><div class="ttdeci">void fpga_con_init(char *host, int lport)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:1037</div></div>
<div class="ttc" id="structaddress_html_aacbeb5a1db9cfa6bcabb47d819818b1e"><div class="ttname"><a href="structaddress.html#aacbeb5a1db9cfa6bcabb47d819818b1e">address::d_ip_host</a></div><div class="ttdeci">std::string d_ip_host</div><div class="ttdef"><b>Definition:</b> JarsControl.h:68</div></div>
<div class="ttc" id="JarsControl_8h_html_ab8923675701bbbb7f51c4e68fac5e588"><div class="ttname"><a href="JarsControl_8h.html#ab8923675701bbbb7f51c4e68fac5e588">ELECTION_RXD</a></div><div class="ttdeci">#define ELECTION_RXD</div><div class="ttdef"><b>Definition:</b> JarsControl.h:74</div></div>
<div class="ttc" id="JarsControl_8h_html_ae3793cb02de7605c651d1762415629f8"><div class="ttname"><a href="JarsControl_8h.html#ae3793cb02de7605c651d1762415629f8">IPstr_to_bytearray</a></div><div class="ttdeci">void IPstr_to_bytearray(char *IPstr, char *parts)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:1242</div></div>
<div class="ttc" id="structjars__cmd_html_a667569fb6dd6e6bc0b0699d0e1a49b22"><div class="ttname"><a href="structjars__cmd.html#a667569fb6dd6e6bc0b0699d0e1a49b22">jars_cmd::ack</a></div><div class="ttdeci">bool ack</div><div class="ttdef"><b>Definition:</b> JarsControl.h:85</div></div>
<div class="ttc" id="class__JARSControl_html_a6627542a7073fc2a460bc8b5b380f937"><div class="ttname"><a href="class__JARSControl.html#a6627542a7073fc2a460bc8b5b380f937">_JARSControl::jro_MatchParameters</a></div><div class="ttdeci">void jro_MatchParameters(ExpParameters *ExpParam)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:269</div></div>
<div class="ttc" id="struct__GlobPParam_html_a0abce01487be8839d4e3ce356246eb51"><div class="ttname"><a href="struct__GlobPParam.html#a0abce01487be8839d4e3ce356246eb51">_GlobPParam::m_nProfilesperBlock</a></div><div class="ttdeci">unsigned int m_nProfilesperBlock</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:180</div></div>
<div class="ttc" id="JarsControl_8h_html_aacac2365f297d20c92dac6c32a87c6a3"><div class="ttname"><a href="JarsControl_8h.html#aacac2365f297d20c92dac6c32a87c6a3">DISABLE_TRANSF</a></div><div class="ttdeci">#define DISABLE_TRANSF</div><div class="ttdef"><b>Definition:</b> JarsControl.h:78</div></div>
<div class="ttc" id="JarsControl_8h_html_a5a3ca937b4f7181095b415041ac2a152a977ee7b118a6816596e05f1c5c6221f2"><div class="ttname"><a href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a977ee7b118a6816596e05f1c5c6221f2">CHECK_ACK</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:62</div></div>
<div class="ttc" id="ExperimentConstants_8h_html_afec22c32aec0b1d3972cdaba0d0ccec7"><div class="ttname"><a href="ExperimentConstants_8h.html#afec22c32aec0b1d3972cdaba0d0ccec7">CHIP_COMAND</a></div><div class="ttdeci">#define CHIP_COMAND</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:98</div></div>
<div class="ttc" id="structaddress_html_a581926a36870deaba867743219d89d9a"><div class="ttname"><a href="structaddress.html#a581926a36870deaba867743219d89d9a">address::d_path_file</a></div><div class="ttdeci">const char * d_path_file</div><div class="ttdef"><b>Definition:</b> JarsControl.h:65</div></div>
<div class="ttc" id="struct__SystemParam_html_a2fc99bf00c5551764122a0924a1df888"><div class="ttname"><a href="struct__SystemParam.html#a2fc99bf00c5551764122a0924a1df888">_SystemParam::m_nChannels</a></div><div class="ttdeci">unsigned int m_nChannels</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:128</div></div>
<div class="ttc" id="classsp601__command_html_a190c6be31617bd6b50fc7f4a451a56ac"><div class="ttname"><a href="classsp601__command.html#a190c6be31617bd6b50fc7f4a451a56ac">sp601_command::send</a></div><div class="ttdeci">void send(uint8_t cmd, char code, const char *payload, size_t size_payload)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:1095</div></div>
<div class="ttc" id="class__JARSControl_html_a57bb6d2e0d1c5e18bd101de314651e8c"><div class="ttname"><a href="class__JARSControl.html#a57bb6d2e0d1c5e18bd101de314651e8c">_JARSControl::InternalThreadEntry</a></div><div class="ttdeci">void InternalThreadEntry()</div><div class="ttdef"><b>Definition:</b> JarsControl.h:805</div></div>
<div class="ttc" id="structjars__cmd_html_a08d03301fdc843da88b71ab8d5576a97"><div class="ttname"><a href="structjars__cmd.html#a08d03301fdc843da88b71ab8d5576a97">jars_cmd::val</a></div><div class="ttdeci">char val</div><div class="ttdef"><b>Definition:</b> JarsControl.h:83</div></div>
<div class="ttc" id="structjars__cmd_html"><div class="ttname"><a href="structjars__cmd.html">jars_cmd</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:81</div></div>
<div class="ttc" id="classExpParameters_html"><div class="ttname"><a href="classExpParameters.html">ExpParameters</a></div><div class="ttdef"><b>Definition:</b> ExperimentParameters.h:11</div></div>
<div class="ttc" id="class__JARSControl_html"><div class="ttname"><a href="class__JARSControl.html">_JARSControl</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:102</div></div>
<div class="ttc" id="classExpParameters_html_a3101e02498e631d62ed0a08bbdd97ce4"><div class="ttname"><a href="classExpParameters.html#a3101e02498e631d62ed0a08bbdd97ce4">ExpParameters::MyGRCParam</a></div><div class="ttdeci">GlobRCParam MyGRCParam</div><div class="ttdef"><b>Definition:</b> ExperimentParameters.h:26</div></div>
<div class="ttc" id="class__JARSControl_html_a23d97fafb2a8484a913c9ae0cbf96b53"><div class="ttname"><a href="class__JARSControl.html#a23d97fafb2a8484a913c9ae0cbf96b53">_JARSControl::m_SizeofBuffer</a></div><div class="ttdeci">int m_SizeofBuffer</div><div class="ttdef"><b>Definition:</b> JarsControl.h:117</div></div>
<div class="ttc" id="classsp601__command_html_a0f20108067e472db69a628ecb02e2c4a"><div class="ttname"><a href="classsp601__command.html#a0f20108067e472db69a628ecb02e2c4a">sp601_command::receive</a></div><div class="ttdeci">ssize_t receive(char *buffer_rcv)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:1026</div></div>
<div class="ttc" id="classsp601__command_html_a4acdc1e7593b27a8831b0bea12e27aa5"><div class="ttname"><a href="classsp601__command.html#a4acdc1e7593b27a8831b0bea12e27aa5">sp601_command::~sp601_command</a></div><div class="ttdeci">~sp601_command()</div><div class="ttdef"><b>Definition:</b> JarsControl.h:967</div></div>
<div class="ttc" id="class__JARSControl_html_af22ac24cb398de0720ab962d79a8498f"><div class="ttname"><a href="class__JARSControl.html#af22ac24cb398de0720ab962d79a8498f">_JARSControl::m_AcqBuffer</a></div><div class="ttdeci">void * m_AcqBuffer</div><div class="ttdef"><b>Definition:</b> JarsControl.h:118</div></div>
<div class="ttc" id="classMemoryManager_html"><div class="ttname"><a href="classMemoryManager.html">MemoryManager</a></div><div class="ttdef"><b>Definition:</b> MemoryManager.h:9</div></div>
<div class="ttc" id="class__JARSControl_html_a3a9bee0735edcc19019ea89c876bb324"><div class="ttname"><a href="class__JARSControl.html#a3a9bee0735edcc19019ea89c876bb324">_JARSControl::MyExpParam</a></div><div class="ttdeci">ExpParameters * MyExpParam</div><div class="ttdef"><b>Definition:</b> JarsControl.h:116</div></div>
<div class="ttc" id="JarsControl_8h_html_acdbbef5f7b2938fa8a308d3a7237723e"><div class="ttname"><a href="JarsControl_8h.html#acdbbef5f7b2938fa8a308d3a7237723e">intToBytes</a></div><div class="ttdeci">void intToBytes(int number, char *arrayOfByte, size_t size)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:1282</div></div>
<div class="ttc" id="JarsControl_8h_html_a186f7c0fc2f44b39853cd79d8daa6b65"><div class="ttname"><a href="JarsControl_8h.html#a186f7c0fc2f44b39853cd79d8daa6b65">bytearray_to_MACstr</a></div><div class="ttdeci">void bytearray_to_MACstr(const char *bytes, char *MACstr)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:1289</div></div>
<div class="ttc" id="JarsControl_8h_html_ac35468256656a04613e24a7e08d81167"><div class="ttname"><a href="JarsControl_8h.html#ac35468256656a04613e24a7e08d81167">cfg</a></div><div class="ttdeci">sp601_config cfg</div><div class="ttdef"><b>Definition:</b> JarsControl.h:200</div></div>
<div class="ttc" id="classsp601__command_html_a00e7747470750f26ba33b69b9a1b028b"><div class="ttname"><a href="classsp601__command.html#a00e7747470750f26ba33b69b9a1b028b">sp601_command::init</a></div><div class="ttdeci">void init(address host_address)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:970</div></div>
<div class="ttc" id="struct__GlobRCParam_html_abc125c5fd3f6736a5df976d249f7ae42"><div class="ttname"><a href="struct__GlobRCParam.html#abc125c5fd3f6736a5df976d249f7ae42">_GlobRCParam::Dyn_sfAcqDH</a></div><div class="ttdeci">float * Dyn_sfAcqDH</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:194</div></div>
<div class="ttc" id="JarsControl_8h_html_ae6cae658beb94f4ddfcaa58ee33dd38b"><div class="ttname"><a href="JarsControl_8h.html#ae6cae658beb94f4ddfcaa58ee33dd38b">RCV_BUFSIZE</a></div><div class="ttdeci">#define RCV_BUFSIZE</div><div class="ttdef"><b>Definition:</b> JarsControl.h:60</div></div>
<div class="ttc" id="JarsControl_8h_html_a0a6858dd58a8b8b154e5dd149fafd01d"><div class="ttname"><a href="JarsControl_8h.html#a0a6858dd58a8b8b154e5dd149fafd01d">bytearray_to_IPstr</a></div><div class="ttdeci">void bytearray_to_IPstr(const char *bytes, char *IPstr)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:1255</div></div>
<div class="ttc" id="JarsControl_8h_html_a5a3ca937b4f7181095b415041ac2a152abd7b2f700ca4ef2b11180557059e6bbd"><div class="ttname"><a href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152abd7b2f700ca4ef2b11180557059e6bbd">SET_COMMS_IP</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:62</div></div>
<div class="ttc" id="JarsControl_8h_html_a5a3ca937b4f7181095b415041ac2a152a28b6b130f7a5b8cdbee96bb17ef151af"><div class="ttname"><a href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a28b6b130f7a5b8cdbee96bb17ef151af">SEND_FILTER</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:62</div></div>
<div class="ttc" id="classsp601__config_html_aa8d75acd776756f7b46560c340a4817d"><div class="ttname"><a href="classsp601__config.html#aa8d75acd776756f7b46560c340a4817d">sp601_config::PORT_host</a></div><div class="ttdeci">int PORT_host</div><div class="ttdef"><b>Definition:</b> JarsControl.h:189</div></div>
<div class="ttc" id="class__JARSControl_html_a643f89d471e0690716b0aae9cb39b10f"><div class="ttname"><a href="class__JARSControl.html#a643f89d471e0690716b0aae9cb39b10f">_JARSControl::InternalRcvFunc</a></div><div class="ttdeci">static void * InternalRcvFunc(void *This)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:748</div></div>
<div class="ttc" id="class__JARSControl_html_a3a32dd8bf71407e2657267980476ca50"><div class="ttname"><a href="class__JARSControl.html#a3a32dd8bf71407e2657267980476ca50">_JARSControl::jro_StopAcquisition</a></div><div class="ttdeci">bool jro_StopAcquisition()</div><div class="ttdef"><b>Definition:</b> JarsControl.h:686</div></div>
<div class="ttc" id="class__JARSControl_html_a96cc4161869c0e963d31fd2d462f7f01"><div class="ttname"><a href="class__JARSControl.html#a96cc4161869c0e963d31fd2d462f7f01">_JARSControl::InternalCallback</a></div><div class="ttdeci">void InternalCallback()</div><div class="ttdef"><b>Definition:</b> JarsControl.h:888</div></div>
<div class="ttc" id="classMemoryManager_html_a1ddfeb3818503fad3b94d8b0fdb1a1fd"><div class="ttname"><a href="classMemoryManager.html#a1ddfeb3818503fad3b94d8b0fdb1a1fd">MemoryManager::m_mAcqBuffer</a></div><div class="ttdeci">complex&lt; short &gt; ** m_mAcqBuffer</div><div class="ttdef"><b>Definition:</b> MemoryManager.h:16</div></div>
<div class="ttc" id="struct__SystemParam_html_abb9ba419e2dd0853d6d43e1a32f3de7a"><div class="ttname"><a href="struct__SystemParam.html#abb9ba419e2dd0853d6d43e1a32f3de7a">_SystemParam::m_nNumberOfChannel</a></div><div class="ttdeci">unsigned int m_nNumberOfChannel[8]</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:135</div></div>
<div class="ttc" id="JarsControl_8h_html_a5a3ca937b4f7181095b415041ac2a152"><div class="ttname"><a href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152">JARS_CMD</a></div><div class="ttdeci">JARS_CMD</div><div class="ttdef"><b>Definition:</b> JarsControl.h:62</div></div>
<div class="ttc" id="JarsControl_8h_html_a5a3ca937b4f7181095b415041ac2a152af2fb94d1fd1739ad68220e57882efa23"><div class="ttname"><a href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152af2fb94d1fd1739ad68220e57882efa23">GET_VALUE</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:62</div></div>
<div class="ttc" id="class__JARSControl_html_a83109c7d938a17dcd5344b8984489490"><div class="ttname"><a href="class__JARSControl.html#a83109c7d938a17dcd5344b8984489490">_JARSControl::ptrFunc</a></div><div class="ttdeci">void(* ptrFunc)(bool success)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:120</div></div>
<div class="ttc" id="class__JARSControl_html_a8a5f2a09daffa77a92e351be46f607a2"><div class="ttname"><a href="class__JARSControl.html#a8a5f2a09daffa77a92e351be46f607a2">_JARSControl::_JARSControl</a></div><div class="ttdeci">_JARSControl()</div><div class="ttdef"><b>Definition:</b> JarsControl.h:243</div></div>
<div class="ttc" id="ExperimentConstants_8h_html_a722e5785aae222e3f5f8f1e48db2e1fa"><div class="ttname"><a href="ExperimentConstants_8h.html#a722e5785aae222e3f5f8f1e48db2e1fa">SYNCHRO</a></div><div class="ttdeci">#define SYNCHRO</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:32</div></div>
<div class="ttc" id="class__JARSControl_html_a3373fa4a920c76cf6d66d1668d7b389c"><div class="ttname"><a href="class__JARSControl.html#a3373fa4a920c76cf6d66d1668d7b389c">_JARSControl::~_JARSControl</a></div><div class="ttdeci">~_JARSControl()</div><div class="ttdef"><b>Definition:</b> JarsControl.h:258</div></div>
<div class="ttc" id="structjars__cmd_html_ac1538c1c69d889eefbabfc077e59d96f"><div class="ttname"><a href="structjars__cmd.html#ac1538c1c69d889eefbabfc077e59d96f">jars_cmd::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> JarsControl.h:82</div></div>
<div class="ttc" id="JarsControl_8h_html_a5a3ca937b4f7181095b415041ac2a152abff6b2d1371663911c20d04738892bfd"><div class="ttname"><a href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152abff6b2d1371663911c20d04738892bfd">SET_SP601_IP</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:62</div></div>
<div class="ttc" id="struct__RadarControllerParam_html_a11c44c04097c6e7a89f0f4c1c6b92f2d"><div class="ttname"><a href="struct__RadarControllerParam.html#a11c44c04097c6e7a89f0f4c1c6b92f2d">_RadarControllerParam::m_nNTX</a></div><div class="ttdeci">unsigned int m_nNTX</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:142</div></div>
<div class="ttc" id="class__JARSControl_html_a580e2201213c8276faaa2022c28d5a03"><div class="ttname"><a href="class__JARSControl.html#a580e2201213c8276faaa2022c28d5a03">_JARSControl::jro_InitAcquisition</a></div><div class="ttdeci">bool jro_InitAcquisition()</div><div class="ttdef"><b>Definition:</b> JarsControl.h:581</div></div>
<div class="ttc" id="ExperimentConstants_8h_html_ad727a3b9d581739d2e5e88b1716ee1dd"><div class="ttname"><a href="ExperimentConstants_8h.html#ad727a3b9d581739d2e5e88b1716ee1dd">CHIP_ALL</a></div><div class="ttdeci">#define CHIP_ALL</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:97</div></div>
<div class="ttc" id="JarsControl_8h_html_a9fe1a038e1882c74961f61186cc7a811"><div class="ttname"><a href="JarsControl_8h.html#a9fe1a038e1882c74961f61186cc7a811">MACstr_to_bytearray</a></div><div class="ttdeci">void MACstr_to_bytearray(char *MACstr, char *parts)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:1268</div></div>
<div class="ttc" id="JarsControl_8h_html_a19a52ae0d3c91c019542bc76a720aef9"><div class="ttname"><a href="JarsControl_8h.html#a19a52ae0d3c91c019542bc76a720aef9">bytearray_to_int</a></div><div class="ttdeci">void bytearray_to_int(const char *byte_array, int num)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:1261</div></div>
<div class="ttc" id="class__JARSControl_html_a6c19d395de3d648bc66f2b7f886fe10c"><div class="ttname"><a href="class__JARSControl.html#a6c19d395de3d648bc66f2b7f886fe10c">_JARSControl::InternalThreadEntryFunc</a></div><div class="ttdeci">static void * InternalThreadEntryFunc(void *This)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:797</div></div>
<div class="ttc" id="classsp601__command_html_ab96dc6299f8ee6dd7bde84584ea72d5f"><div class="ttname"><a href="classsp601__command.html#ab96dc6299f8ee6dd7bde84584ea72d5f">sp601_command::sp601_command</a></div><div class="ttdeci">sp601_command()</div><div class="ttdef"><b>Definition:</b> JarsControl.h:964</div></div>
<div class="ttc" id="JarsControl_8h_html_a063240a0c681e13158e249f55ac4b750"><div class="ttname"><a href="JarsControl_8h.html#a063240a0c681e13158e249f55ac4b750">POWER_RXD</a></div><div class="ttdeci">#define POWER_RXD</div><div class="ttdef"><b>Definition:</b> JarsControl.h:75</div></div>
<div class="ttc" id="ExperimentConstants_8h_html_a45ab7a7b703b2e5615905682f51b9e1d"><div class="ttname"><a href="ExperimentConstants_8h.html#a45ab7a7b703b2e5615905682f51b9e1d">BY_DATA</a></div><div class="ttdeci">#define BY_DATA</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:109</div></div>
<div class="ttc" id="classsp601__config_html_ad6492c0298daa685d0ba7dfc38a85b14"><div class="ttname"><a href="classsp601__config.html#ad6492c0298daa685d0ba7dfc38a85b14">sp601_config::SP601_IP</a></div><div class="ttdeci">char * SP601_IP</div><div class="ttdef"><b>Definition:</b> JarsControl.h:184</div></div>
<div class="ttc" id="JarsControl_8h_html_a5a3ca937b4f7181095b415041ac2a152a57446329e1b880f1e79096d89ca90abf"><div class="ttname"><a href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a57446329e1b880f1e79096d89ca90abf">SET_COMMS_PORT</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:62</div></div>
<div class="ttc" id="JarsControl_8h_html_a5a3ca937b4f7181095b415041ac2a152a578a2dc0f32dacf50c510f7009c12d1f"><div class="ttname"><a href="JarsControl_8h.html#a5a3ca937b4f7181095b415041ac2a152a578a2dc0f32dacf50c510f7009c12d1f">SET_SP601_PORT</a></div><div class="ttdef"><b>Definition:</b> JarsControl.h:62</div></div>
<div class="ttc" id="JarsControl_8h_html_a52e278dd9e601652e8ab11b70c53ef6e"><div class="ttname"><a href="JarsControl_8h.html#a52e278dd9e601652e8ab11b70c53ef6e">MODE_OPER</a></div><div class="ttdeci">#define MODE_OPER</div><div class="ttdef"><b>Definition:</b> JarsControl.h:73</div></div>
<div class="ttc" id="structaddress_html_a47c83523d9cc06ed386f29e5fcd5eeda"><div class="ttname"><a href="structaddress.html#a47c83523d9cc06ed386f29e5fcd5eeda">address::d_mac_block</a></div><div class="ttdeci">std::string d_mac_block</div><div class="ttdef"><b>Definition:</b> JarsControl.h:66</div></div>
<div class="ttc" id="struct__GlobRCParam_html_a75b52d816c427cacd56aa202274565cf"><div class="ttname"><a href="struct__GlobRCParam.html#a75b52d816c427cacd56aa202274565cf">_GlobRCParam::Dyn_snAcqNSA</a></div><div class="ttdeci">unsigned int * Dyn_snAcqNSA</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:200</div></div>
<div class="ttc" id="struct__RadarControllerParam_html_ae8ac79e57158371f6524e1d160b0d96e"><div class="ttname"><a href="struct__RadarControllerParam.html#ae8ac79e57158371f6524e1d160b0d96e">_RadarControllerParam::m_fIPP</a></div><div class="ttdeci">float m_fIPP</div><div class="ttdef"><b>Definition:</b> ExperimentConstants.h:143</div></div>
<div class="ttc" id="classsp601__config_html_a6d8f61af0597bc1c6ca208898fc76f77"><div class="ttname"><a href="classsp601__config.html#a6d8f61af0597bc1c6ca208898fc76f77">sp601_config::VERBOSE_MODE</a></div><div class="ttdeci">bool VERBOSE_MODE</div><div class="ttdef"><b>Definition:</b> JarsControl.h:194</div></div>
<div class="ttc" id="class__JARSControl_html_a7ee41ba1eaf9a77999e55fcda1660cf2"><div class="ttname"><a href="class__JARSControl.html#a7ee41ba1eaf9a77999e55fcda1660cf2">_JARSControl::InternalCallbackFunc</a></div><div class="ttdeci">static void * InternalCallbackFunc(void *This)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:883</div></div>
<div class="ttc" id="classsp601__config_html_a5f4214fdc2d5b4cc6cf2665ad6233838"><div class="ttname"><a href="classsp601__config.html#a5f4214fdc2d5b4cc6cf2665ad6233838">sp601_config::IP_host</a></div><div class="ttdeci">char * IP_host</div><div class="ttdef"><b>Definition:</b> JarsControl.h:187</div></div>
<div class="ttc" id="JarsControl_8h_html_ab25fcf174daff72a94fd8a69424c6a2e"><div class="ttname"><a href="JarsControl_8h.html#ab25fcf174daff72a94fd8a69424c6a2e">JARSControl</a></div><div class="ttdeci">_JARSControl JARSControl</div><div class="ttdef"><b>Definition:</b> JarsControl.h:175</div></div>
<div class="ttc" id="JarsControl_8h_html_acc668b68847453065b3681978e25f217"><div class="ttname"><a href="JarsControl_8h.html#acc668b68847453065b3681978e25f217">destino_endpoint</a></div><div class="ttdeci">boost::asio::ip::udp::endpoint destino_endpoint</div><div class="ttdef"><b>Definition:</b> JarsControl.h:44</div></div>
<div class="ttc" id="class__JARSControl_html_a1dc4dd8d70448789ea8df65ee92eae82"><div class="ttname"><a href="class__JARSControl.html#a1dc4dd8d70448789ea8df65ee92eae82">_JARSControl::jro_AssignMemory</a></div><div class="ttdeci">void jro_AssignMemory(MemoryManager *MemManager, void(*ptrClientFunc)(bool sucess), address host_address)</div><div class="ttdef"><b>Definition:</b> JarsControl.h:279</div></div>
<div class="ttc" id="classsp601__config_html_a8425fde699cfd9476b57621d6ef53129"><div class="ttname"><a href="classsp601__config.html#a8425fde699cfd9476b57621d6ef53129">sp601_config::SP601_MAC</a></div><div class="ttdeci">char * SP601_MAC</div><div class="ttdef"><b>Definition:</b> JarsControl.h:183</div></div>
<div class="ttc" id="JarsControl_8h_html_aefde68a634d66b7039aa56de3fd5301b"><div class="ttname"><a href="JarsControl_8h.html#aefde68a634d66b7039aa56de3fd5301b">PROG_RXD</a></div><div class="ttdeci">#define PROG_RXD</div><div class="ttdef"><b>Definition:</b> JarsControl.h:76</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_1490c80a2e6495e463704d21dd58f7b5.html">SetSystem</a></li><li class="navelem"><a class="el" href="dir_4bf5678b1a74f49d401dcba3bce47ba5.html">ArgProcessor</a></li><li class="navelem"><a class="el" href="dir_7d3bf389443e6c19a7262b44fef2310c.html">JarsControl</a></li><li class="navelem"><a class="el" href="JarsControl_8h.html">JarsControl.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
